{"version":3,"sources":["webpack:///./src/common/threejs/threeDBuilder/ThreeDimensionalBuilder.vue?4c4c","webpack:///./src/common/threejs/threeDBuilder/ThreeDimensionalBuilder.vue?8f3c","webpack:///./src/common/threejs/threeDBuilder/ThreeDimensionalBuilder.vue","webpack:///./src/assets/threejs/TransformControls.js","webpack:///./src/assets/threejs/OrientationControls2.js","webpack:///./src/common/threejs/threeDBuilder/ThreeDimensionalBuilder.vue?e67a","webpack:///./src/common/threejs/threeDBuilder/ThreeDimensionalBuilder.vue?3610","webpack:///./src/assets/threejs/common.css?dcf7","webpack:///src/common/threejs/threeDBuilder/ThreeDimensionalBuilder.vue"],"names":["TransformControls","camera","domElement","undefined","console","warn","document","Object3D","call","visible","_gizmo","TransformControlsGizmo","add","_plane","TransformControlsPlane","scope","defineProperty","changeEvent","type","mouseDownEvent","mouseUpEvent","mode","objectChangeEvent","raycaster","Raycaster","intersectObjectWithRay","object","includeInvisible","allIntersections","intersectObject","i","length","_tempVector","Vector3","_tempVector2","_tempQuaternion","Quaternion","_unit","X","Y","Z","pointStart","pointEnd","offset","rotationAxis","startNorm","endNorm","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentQuaternionInv","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldQuaternionInv","worldScale","eye","positionStart","quaternionStart","scaleStart","addEventListener","onPointerDown","onPointerHover","ownerDocument","onPointerUp","dispose","removeEventListener","onPointerMove","traverse","child","geometry","material","attach","activelength","$","name","window","focusedTransformObj","log","deleteObjFlag","show","removeClass","setTimeout","addClass","hide","detach","axis","propName","defaultValue","propValue","Object","get","set","value","dispatchEvent","updateMatrixWorld","parent","error","matrixWorld","decompose","copy","invert","sub","normalize","prototype","pointerHover","pointer","dragging","setFromCamera","intersect","picker","pointerDown","button","planeIntersect","space","snap","rotationSnap","rotation","x","Math","round","y","z","position","quaternion","scale","point","pointerMove","applyQuaternion","indexOf","divide","translationSnap","search","setFromMatrixPosition","d","dot","multiply","scaleSnap","ROTATION_SPEED","distanceTo","angleTo","cross","setFromAxisAngle","pointerUp","getPointer","event","pointerLockElement","changedTouches","rect","getBoundingClientRect","clientX","left","width","clientY","top","height","enabled","pointerType","style","touchAction","getMode","setMode","setTranslationSnap","setRotationSnap","setScaleSnap","setSize","size","setSpace","update","assign","create","constructor","isTransformControls","gizmoMaterial","MeshBasicMaterial","depthTest","depthWrite","transparent","side","DoubleSide","fog","toneMapped","gizmoLineMaterial","LineBasicMaterial","linewidth","matInvisible","clone","opacity","matHelper","matRed","color","matGreen","matBlue","matWhiteTransparent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matYellow","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","CylinderBufferGeometry","scaleHandleGeometry","BoxBufferGeometry","lineGeometry","BufferGeometry","setAttribute","Float32BufferAttribute","CircleGeometry","radius","arc","vertices","push","cos","PI","sin","TranslateHelperGeometry","gizmoTranslate","Mesh","Line","XYZ","OctahedronBufferGeometry","XY","PlaneBufferGeometry","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","TorusBufferGeometry","SphereBufferGeometry","gizmoScale","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix4","matrix","renderOrder","Infinity","tempVector","tempEuler","Euler","alignVector","zeroVector","lookAtMatrix","Matrix4","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","concat","children","handle","factor","isOrthographicCamera","bottom","zoom","min","tan","fov","multiplyScalar","setFromEuler","abs","setFromRotationMatrix","lookAt","AXIS_HIDE_TRESHOLD","PLANE_HIDE_TRESHOLD","AXIS_FLIP_TRESHOLD","atan2","multiplyQuaternions","showX","showY","showZ","_opacity","_color","lerp","Color","split","some","a","isTransformControlsGizmo","wireframe","dirVector","tempMatrix","isTransformControlsPlane","OrientationControls","epsilon","getObjectCSSMatrix","elements","matrix3d","defaultStyle","sides","front","right","back","offsets","n","e","s","w","options","unit","half","perspective","cssElement","head","getElementsByTagName","element","createElement","id","href","appendChild","createTextNode","insertBefore","firstChild","container","className","box","fontSize","ring","R","directions","direction","toLowerCase","fs","textContent","transform","plane","replace","lineHeight","matrixWorldInverse","WebkitTransform","isPerspectiveCamera","pow"],"mappings":"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;;AACA;;AACA;;AAEA;AACA;;AAEA,oBA7BA,CA+BA;;;AACA,4HAhCA,CAgCA;;AACA;;AACA;AACA;;AACA,wCApCA,CAqCA;AACA;;;AACA;;AACA,4BAxCA,CAyCA;AACA;;;AACA;;AACA;AACA,KA9CA;AA+CA,SA/CA,mBA+CA;AACA;AACA,2JAFA,CAGA;;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA,2CAjBA,CAkBA;AACA,KAlEA;AAmEA,WAnEA,qBAmEA;AACA;AACA;AACA;AACA;AACA;AACA,wCANA,CAMA;;AACA;AACA,uDARA,CAQA;;AACA,sDATA,CASA;;AACA,oCAVA,CAUA;AACA;;AAEA;AACA;AACA,wGAfA,CAgBA;AACA,KApFA;AAqFA,aArFA,uBAqFA;AACA,uBADA,CAEA;;;AACA,qKAHA,CAGA;;AACA,sCAJA,CAIA;;AACA,wCALA,CAKA;;AACA;AACA;AACA;AACA,gBADA;AACA;AACA,cAFA;AAEA;AACA,iBAHA;AAGA;AACA,kBAJA,CAIA;;AAJA;AAMA,uCAdA,CAcA;;AACA,uCAfA,CAeA;AACA;;AACA;AACA;;AACA;AACA;AAAA;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;AACA,WAPA,MAOA;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;AACA;AACA,SAnBA,MAmBA;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;AACA;AACA,OAhCA;AAiCA,KAvIA;AAwIA,iBAxIA,2BAwIA;AACA,uBADA,CAEA;;;AACA;AACA;AACA;;AACA;;AACA;AACA;AACA;AACA;AACA;AACA,OALA,EAKA,KALA;;AAMA;AACA;AACA;AACA;;AACA;;AACA;AACA,OANA,EAMA,KANA;;AAOA;AACA;;AACA;AACA,OAHA,EAGA,KAHA;;AAIA;AACA;AACA,OAFA,EAEA,KAFA;;AAGA;AACA;AACA;AACA;;AACA;;AACA;AACA;AACA;AACA,OARA,EAQA,KARA,EA3BA,CAoCA;;AACA,KA7KA;AA8KA,sBA9KA,gCA8KA;AACA;AACA;AACA;AACA,KAlLA;AAmLA,sBAnLA,gCAmLA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA3LA;AA4LA,sBA5LA,gCA4LA,CACA;AACA,KA9LA;AA+LA,oBA/LA,8BA+LA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA,SAFA,EAEA,GAFA;AAGA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA/MA;AAgNA,mBAhNA,6BAgNA;AACA;;AACA,4IAFA,CAEA;;AACA;;AACA;AACA;AACA;AACA;;AACA;;AACA;AACA;;AACA;;AACA;AACA;;AACA;;AACA;AACA;;AACA;;AACA;AACA;;AACA;;AACA;AACA;;AACA;AAlBA;;AAoBA;;AACA;AACA,OAvBA;AAyBA,KA7OA;AA8OA,WA9OA,qBA8OA;AACA;AACA,oDAFA,CAGA;AACA;AACA,KAnPA;AAoPA,kBApPA,4BAoPA;AACA;AACA;AACA,uEAFA,CAGA;AACA;AAEA,OANA,MAMA;AACA;AACA,6EAFA,CAGA;AACA;AACA;;AACA;AACA,KAlQA;AAmQA,cAnQA,sBAmQA,WAnQA,EAmQA;AACA;AACA;AACA,KAtQA;AAuQA,UAvQA,oBAuQA;AACA;AACA,KAzQA;AA0QA,cA1QA,wBA0QA;AACA;AACA,0BACA,IADA,CACA,mBADA,EAEA,KAFA,CAEA;AACA;AACA,OAJA;AAKA,KAjRA;AAkRA,kBAlRA,0BAkRA,GAlRA,EAkRA;AACA;AACA;AACA,gDAFA,CAGA;AACA;AACA,KAxRA;AAyRA,cAzRA,sBAyRA,IAzRA,EAyRA;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA,KAjSA;AAkSA,cAlSA,wBAkSA;AACA;AACA;AACA,KArSA;AAsSA,cAtSA,wBAsSA;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;;AACA;AACA,KA/SA;AAgTA,oBAhTA,8BAgTA;AACA;;AACA;AACA;AACA;AACA;AACA,OAJA;;AAKA;AACA;AACA;AACA;AACA;;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA;;AACA,8CAfA,CAgBA;AACA;;;AACA;AACA;AACA;AACA,OA1BA,EA0BA,KA1BA;;AA2BA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA,OAvBA,EAuBA,KAvBA;;AAwBA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA,WAFA,MAEA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA,WAFA,EAEA,GAFA;AAGA,SAzBA,MAyBA;AACA;AACA;;AACA;AACA;AACA,OA/BA,EA+BA,KA/BA;;AAiCA;AACA;AACA;AACA;AACA,OAJA;;AAKA;AACA;AACA;AACA;AACA;;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA;;AACA,8CAfA,CAgBA;AACA;;;AACA;AACA;AACA;AACA,OA1BA,EA0BA,KA1BA;;AA2BA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA,OAvBA,EAuBA,KAvBA;;AAwBA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA,WAFA,MAEA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA,WAFA,EAEA,GAFA;AAGA,SAzBA,MAyBA;AACA;AACA;;AACA;AACA;AACA,OA/BA,EA+BA,KA/BA;AAgCA,KAneA;AAoeA,WApeA,mBAoeA,CApeA,EAoeA;AACA,uBADA,CAEA;;;AACA;AACA;AACA;;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,SAJA,MAIA;AACA;AACA;AACA;AACA,SAJA,MAIA;AACA;AACA;AACA;AACA;;AACA,4CAfA,CAgBA;AACA;;;AACA;AACA;AACA;AACA,KA/fA;AAggBA,WAhgBA,mBAggBA,CAhgBA,EAggBA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA,KAvhBA;AAwhBA,SAxhBA,iBAwhBA,CAxhBA,EAwhBA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,SAJA,MAIA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA,SAFA,EAEA,GAFA;AAGA,OAzBA,MAyBA;AACA;AACA;;AACA;AACA;AACA,KAxjBA;AAyjBA,gBAzjBA,wBAyjBA,IAzjBA,EAyjBA,IAzjBA,EAyjBA,KAzjBA,EAyjBA,MAzjBA,EAyjBA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA;;AACA;AAEA,KAhlBA;AAilBA,aAjlBA,qBAilBA,IAjlBA,EAilBA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAvlBA;AAwlBA,YAxlBA,oBAwlBA,SAxlBA,EAwlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA/lBA;AAgmBA,gBAhmBA,wBAgmBA,GAhmBA,EAgmBA;AACA,0BADA,CACA;AACA;;AACA;AACA,6BAJA,CAIA;AACA;;AACA;AACA;;;;AAGA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,2LAFA,CAEA;;AACA;;AACA;AACA;AACA,kKAFA,CAEA;;AACA;;AACA;AACA;AACA,uJAFA,CAEA;;AACA;;AACA;AACA;AACA,qIAFA,CAEA;;AACA;;AACA;AACA;AACA,0LAFA,CAEA;;AACA;;AACA;AACA;AACA,iKAFA,CAEA;;AACA;;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BADA;AAEA,+BAFA;AAGA,oBAHA;AAIA;AAJA;AAMA;AACA;AACA,qCArBA,CAqBA;;AACA;;AACA;AACA;AACA,0LAFA,CAEA;;AACA;;AACA;AACA;AACA;AA1DA,OAVA,CAsEA;;;AACA;AACA,KAxqBA;AAyqBA,aAzqBA,qBAyqBA,IAzqBA,EAyqBA;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA;AACA,KAlrBA;AAmrBA,eAnrBA,uBAmrBA,CAnrBA,EAmrBA;AACA;AACA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KA5rBA;AA6rBA,cA7rBA,wBA6rBA;AACA;;AACA;;AACA;;AACA;AACA;;AACA;;AACA;AACA,OAJA,EAKA;AACA;AACA;AACA;AACA,OATA,EAUA;AACA;AACA;AACA,OAbA;AAcA,KA/sBA;AAgtBA,cAhtBA,wBAgtBA;AACA;;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AAjBA;;AAmBA;AACA,4BADA;AAEA,sBAFA;AAGA,kBAHA;AAGA;AACA,yBAJA;AAKA;AALA;AAOA;AACA;AACA;AACA;AAEA,8EArCA,CAqCA;;AACA;AACA,uCAvCA,CAuCA;AACA;;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;AACA;;AACA;;AACA,iCAhDA,CAgDA;;;AACA;AACA;AACA;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;AACA,KA3wBA;AA4wBA,WA5wBA,mBA4wBA,OA5wBA,EA4wBA,GA5wBA,EA4wBA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACA,qBADA,GACA,MADA;;AAEA;;AACA;AACA;AACA,wCALA,CAKA;AACA;;AACA;AACA;AARA,8BAUA,OAVA;AAAA,gDAWA,CAXA,wBAcA,CAdA,wBAiBA,CAjBA,wBAoBA,CApBA,wBAuBA,CAvBA,wBA0BA,CA1BA,wBA6BA,CA7BA,wBAgCA,CAhCA,wBAmCA,CAnCA,wBAsCA,CAtCA,wBAyCA,EAzCA,wBA4CA,EA5CA;AAAA;;AAAA;AAYA;AAZA;;AAAA;AAeA;AAfA;;AAAA;AAkBA;AAlBA;;AAAA;AAqBA;AArBA;;AAAA;AAwBA;AAxBA;;AAAA;AA2BA;AA3BA;;AAAA;AA8BA;AA9BA;;AAAA;AAiCA;AAjCA;;AAAA;AAoCA;AApCA;;AAAA;AAuCA;AAvCA;;AAAA;AA0CA;AA1CA;;AAAA;AA6CA;AA7CA;;AAAA;AAgDA;;AAhDA;AAkDA,sBAlDA,GAkDA,6FAlDA;AAAA;AAAA,uBAmDA;AACA;AACA;AACA,iBAHA,EAIA;AACA,sEADA,CAEA;AACA,iBAPA,CAnDA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA2DA,KAv0BA;AAw0BA,uBAx0BA,iCAw0BA;AACA;AACA;AACA,+CAFA,CAEA;;AACA;;AACA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA,SAPA,MAOA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA;;AAEA,8DApBA,CAsBA;;AACA;;AAEA;AAEA,wCAFA,CAIA;;AAEA;AAEA;AAEA;AAEA;AAEA,aARA,CAUA;;AAEA,WAZA,MAYA;AACA;AACA;AACA;AACA;AACA,8EAHA,CAIA;;AACA;AAAA;AACA;AACA;AACA,eAHA,MAGA;AACA;AACA;AACA,eAHA,MAGA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,yCApBA,CAoBA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AAEA;AACA,OAlFA,MAkFA;AACA;AACA;AACA,KA95BA;AA+5BA,uBA/5BA,iCA+5BA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;;AACA;AACA,KA16BA;AA26BA,yBA36BA,iCA26BA,OA36BA,EA26BA,IA36BA,EA26BA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA37BA;AA47BA,gBA57BA,wBA47BA,CA57BA,EA47BA,IA57BA,EA47BA;AAAA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,OAnBA,MAmBA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,OAnBA,MAmBA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAp/BA;AAq/BA,oBAr/BA,8BAq/BA;AAAA;AACA;AACA;AAAA;AAAA;AACA;;AACA;AACA,KA1/BA;AA2/BA,qBA3/BA,6BA2/BA,MA3/BA,EA2/BA;AACA;AACA;AACA,KA9/BA;AA+/BA,uBA//BA,+BA+/BA,GA//BA,EA+/BA;AACA;AACA,oCADA,CAEA;AACA;AACA,KApgCA;AAqgCA,oBArgCA,8BAqgCA;AACA;;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AATA;;AAWA;AACA,OApBA,MAoBA;AACA;AACA;AACA,KA9hCA;AA+hCA,kBA/hCA,4BA+hCA;AACA;AACA;AAAA;AAAA;AACA,KAliCA;AAmiCA,qBAniCA,6BAmiCA,KAniCA,EAmiCA;AACA;;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;;AACA;AACA;AAEA,4CAZA,CAYA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA,+CADA,CAEA;AACA;;AACA;AACA;;AACA;AACA;AACA;AACA;AAEA,4EAXA,CAYA;;AAEA,2EAdA,CAcA;;AACA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA;;AACA;AACA;;AACA;AACA;AAEA,OA5BA,MA4BA;AACA;AAEA,2EAHA,CAGA;;AACA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA,KAnmCA;AAomCA,YApmCA,sBAomCA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,KAxmCA;AAymCA,mBAzmCA,6BAymCA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAnnCA;AAonCA,sBApnCA,8BAonCA,GApnCA,EAonCA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OANA,MAMA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA,KAtoCA;AAuoCA,mBAvoCA,6BAuoCA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;AACA;AACA;AACA,qCADA,CAEA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;AACA,aANA,MAMA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;AACA,aANA,MAMA;AACA;AAAA;AACA;AACA,eAFA,MAEA;AACA;AACA;AACA;AACA,eAJA,MAIA;AACA;AACA;AACA;AACA,eAJA,MAIA;AACA;AACA;AACA;;AACA;;AACA;AACA;AAxCA;;AA0CA;AACA;AACA;AACA,KAlsCA;AAmsCA,aAnsCA,qBAmsCA,IAnsCA,EAmsCA,GAnsCA,EAmsCA;AAAA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;AACA;AACA,WATA,MASA;AACA;AACA;AACA,SAbA,MAaA;AACA;AACA;AACA,OA7BA,MA6BA;AACA;AACA;AACA,KApuCA;AAquCA,kBAruCA,0BAquCA,IAruCA,EAquCA;AACA;AACA;AACA;;AACA;AACA,kCALA,CAKA;;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;;AACA;AACA,mEADA,CACA;AACA;AACA,OAHA,MAGA;AACA,mEADA,CACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AAnBA;;AAqBA;AAEA,KAxxCA;AAyxCA,mBAzxCA,6BAyxCA;AACA;AACA,kCAFA,CAEA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,qCAZA,CAaA;;AACA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AAEA,KAhzCA;AAizCA,sBAjzCA,8BAizCA,IAjzCA,EAizCA;AACA;;AACA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA,KA9zCA;AA+zCA,YA/zCA,oBA+zCA,IA/zCA,EA+zCA;AAAA;AACA;AACA,kCAFA,CAEA;;AACA;AACA;AACA;;AACA;AACA;AACA,2EADA,CACA;;AACA,8CAFA,CAEA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WANA,MAMA;AACA;AACA;AACA;AACA;AACA;AACA,WANA,MAMA;AACA,+DADA,CACA;;AACA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AAEA,OArCA,MAqCA;AACA;AACA,iFADA,CACA;;AACA,iDAFA,CAEA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WANA,MAMA;AACA;AACA;AACA;AACA;AAEA;AACA,WAPA,MAOA;AACA,wEADA,CACA;;AACA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA,qCAjFA,CAiFA;AACA;;AACA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AAEA,KAp6CA;AAq6CA,eAr6CA,uBAq6CA,QAr6CA,EAq6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA/6CA;AAg7CA,kBAh7CA,0BAg7CA,IAh7CA,EAg7CA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OANA,MAMA;AACA;AACA;AACA,KA17CA;AA27CA,cA37CA,wBA27CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAr8CA;AAs8CA,gBAt8CA,wBAs8CA,IAt8CA,EAs8CA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCATA,CAUA;;AACA,gDAXA,CAWA;;AACA,oCAZA,CAaA;;AACA;AACA,uCAfA,CAgBA;;AACA,4CAjBA,CAkBA;;AACA;AACA;;AACA;AACA,+HADA,CACA;;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA,wBADA;AAEA,+BAFA;AAGA,qCAHA;AAIA,2BAJA;AAKA,4CALA;AAMA;AANA;AAQA;AACA;AACA;AACA,aAHA,EAGA,OAHA;AAIA;AACA;AACA;;;;;;;;;;;;AAUA;AACA;AACA;AACA;AACA,mCAxDA,CAyDA;;AACA;AACA,uCA3DA,CA4DA;AACA;AACA,KArgDA;AAsgDA,cAtgDA,sBAsgDA,IAtgDA,EAsgDA,QAtgDA,EAsgDA;AACA;AAAA;AAAA;AACA,KAxgDA;AAygDA,QAzgDA,gBAygDA,IAzgDA,EAygDA,QAzgDA,EAygDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAnhDA;AAohDA,eAphDA,yBAohDA;AACA,6BADA,CAEA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA,KAxiDA;AAyiDA,gBAziDA,0BAyiDA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OANA,MAMA;AACA;AACA;AACA,KAnjDA;AAojDA,iBApjDA,2BAojDA;AACA;AACA,KAtjDA;AAujDA,oBAvjDA,4BAujDA,IAvjDA,EAujDA;AAAA;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA,KA/jDA;AAgkDA,gBAhkDA,0BAgkDA;AACA;;AACA;AACA;;AACA;AACA;AArkDA,GAxGA;AA+qDA,SA/qDA,qBA+qDA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAFA,EAEA,GAFA;AAGA;AACA;AACA;AACA,KAHA,EAGA,IAHA;AAIA,GAvsDA;AAwsDA;AACA,UADA,oBACA;AACA;AACA,KAHA;AAIA,UAJA,oBAIA;AACA;AACA,KANA;AAOA,UAPA,oBAOA;AACA;AACA;AATA,GAxsDA;AAmtDA,WAntDA,uBAmtDA;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA,uCATA,CASA;AACA,GA7tDA;AA8tDA;AACA,aA/tDA,yBA+tDA;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA,uCATA,CASA;AACA,GAzuDA;AA0uDA;AACA,iBADA,yBACA,MADA,EACA;AACA;AACA;AACA;AACA;AACA,KANA;AAOA,kBAPA,0BAOA,MAPA,EAOA;AACA;AACA;AACA;AACA;AACA,KAZA;AAaA,uBAbA,+BAaA,MAbA,EAaA;AACA;AACA;AACA;AACA;AACA,KAlBA;AAmBA,aAnBA,qBAmBA,MAnBA,EAmBA,MAnBA,EAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1BA;AA1uDA,G","file":"js/chunk-4fae44ed.202252910.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"builder fixedBuilder\"},[_c('div',{class:(\"main_wrapper main_wrapper_\" + (this.$i18n.locale)),attrs:{\"id\":\"mainWrapper\"}},[_c('div',{staticClass:\"clearfix\",attrs:{\"id\":\"container\"},on:{\"click\":_vm.containerListenner,\"mousedown\":_vm.containerMouseDown,\"mousemove\":_vm.containerMouseMove,\"mouseup\":_vm.containerMouseUp}}),_c('div',{staticClass:\"show_more clearfix\",class:_vm.showMore?'':'show_more_close',on:{\"click\":function($event){return _vm.showMoreFn()}}},[_c('img',{attrs:{\"src\":\"/image/3dBuilder/arrow.png\",\"alt\":\"\"}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showMore),expression:\"showMore\"}],staticClass:\"clearfix\",attrs:{\"id\":\"shapes\"}},[(!_vm.shapesListShow && !_vm.cartoonStlShow)?_c('div',{staticClass:\"shapes_wrapper\"},[_c('div',{staticClass:\"shapes_options normal\",on:{\"click\":function($event){return _vm.showModule(0)}}},[_vm._v(_vm._s(_vm.$t('REGULAR'))+\" \"+_vm._s(_vm.$t('MODEL'))+\" \"),_c('i',{staticClass:\"iconfont arrow arrow_right\"},[_vm._v(\"\")])]),_c('div',{staticClass:\"shapes_options cartoon\",on:{\"click\":function($event){return _vm.showModule(1)}}},[_vm._v(_vm._s(_vm.$t('CARTOON'))+\" \"+_vm._s(_vm.$t('MODEL'))+\" \"),_c('i',{staticClass:\"iconfont arrow arrow_right\"},[_vm._v(\"\")])])]):_vm._e(),(_vm.shapesListShow || _vm.cartoonStlShow)?_c('div',{attrs:{\"id\":\"childWrapper\"}},[(_vm.shapesListShow)?_c('div',{staticClass:\"child_wrapper normal_wrapper\"},[_c('div',{staticClass:\"child_title\",on:{\"click\":function($event){return _vm.hideModule()}}},[_c('i',{staticClass:\"iconfont arrow\"},[_vm._v(\"\")]),_vm._v(_vm._s(_vm.$t('REGULAR'))+\" \"+_vm._s(_vm.$t('MODEL'))+\" \")]),_vm._l((_vm.shapesList),function(item,index){return _c('div',{key:index,staticClass:\"module shapes drag\",class:item.title,on:{\"click\":function($event){return _vm.selectModule(0,item.code,index,item.module)}}},[(item.module =='shape')?_c('input',{staticClass:\"this_module\",attrs:{\"type\":\"hidden\",\"value\":\"0\"}}):(item.module =='stl')?_c('input',{staticClass:\"this_module\",attrs:{\"type\":\"hidden\",\"value\":\"1\"}}):(item.module =='text')?_c('input',{staticClass:\"this_module\",attrs:{\"type\":\"hidden\",\"value\":\"2\"}}):_vm._e(),_c('input',{staticClass:\"this_code\",attrs:{\"type\":\"hidden\"},domProps:{\"value\":item.code}}),_c('div',{directives:[{name:\"lazy\",rawName:\"v-lazy:background-image\",value:('/image/3dBuilder/3dPrinting/sprint_'+item.title+'.png'),expression:\"'/image/3dBuilder/3dPrinting/sprint_'+item.title+'.png'\",arg:\"background-image\"}],staticClass:\"drag sprint\",class:'sprint_'+item.title}),_c('div',{staticClass:\"name drag\"},[_vm._v(_vm._s(_vm.$t(item.name)))])])})],2):_vm._e(),(_vm.cartoonStlShow)?_c('div',{staticClass:\"child_wrapper cartoon_wrapper\"},[_c('div',{staticClass:\"child_title\",on:{\"click\":function($event){return _vm.hideModule()}}},[_c('i',{staticClass:\"iconfont arrow\"},[_vm._v(\"\")]),_vm._v(_vm._s(_vm.$t('CARTOON'))+\" \"+_vm._s(_vm.$t('MODEL'))+\" \")]),_vm._l((_vm.cartoonStlList),function(item,index){return _c('div',{key:index,staticClass:\"module lego drag\",class:item.title,on:{\"click\":function($event){return _vm.selectModule(1,item.code,index,item.module)}}},[_c('input',{staticClass:\"this_module\",attrs:{\"type\":\"hidden\",\"value\":\"1\"}}),_c('input',{staticClass:\"this_code\",attrs:{\"type\":\"hidden\"},domProps:{\"value\":index}}),_c('div',{directives:[{name:\"lazy\",rawName:\"v-lazy:background-image\",value:('/image/3dBuilder/3dPrinting/sprint_'+item.title+'.png'),expression:\"'/image/3dBuilder/3dPrinting/sprint_'+item.title+'.png'\",arg:\"background-image\"}],staticClass:\"drag sprint sprintY\",class:'sprint_'+item.title}),_c('div',{staticClass:\"name drag\"},[_vm._v(_vm._s(_vm.$t(item.name)))])])})],2):_vm._e()]):_vm._e()]),_c('div',{staticClass:\"module_btns clearfix\"},[_c('div',{staticClass:\"btn_main go_mainPage\",on:{\"click\":function($event){return _vm.leaveBuilder()}}},[_vm._m(0),_c('div',{staticClass:\"module_btn_name\"},[_vm._v(_vm._s(_vm.$t('BACK')))])]),_c('div',{staticClass:\"btn_main save_module save_stl\",class:_vm.activeSave?'':'noActive_save',on:{\"click\":function($event){return _vm.saveModuleShow(0)}}},[_vm._m(1),_c('div',{staticClass:\"module_btn_name\"},[_vm._v(_vm._s(_vm.$t('SAVE')))])])]),_c('div',{staticClass:\"obj_control has_right_menu\"},[(_vm.controlBar)?_c('div',{staticClass:\"obj_control_wrapper clearfix\"},[_c('div',{staticClass:\"control_btn undo_control \",class:_vm.undoActive?'':'noActive_control',on:{\"click\":function($event){return _vm.redoUndo(0)}}},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")]),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('REDO')))])]),_c('div',{staticClass:\"control_btn redo_control \",class:_vm.redoActive?'':'noActive_control',on:{\"click\":function($event){return _vm.redoUndo(1)}}},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")]),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('UNDO')))])]),_c('div',{staticClass:\"control_btn size_control\",on:{\"click\":function($event){return _vm.changeControls(0)}}},[_vm._m(2),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('CHANGE_SIZE')))])]),_c('div',{staticClass:\"control_btn trans_control active_control\",on:{\"click\":function($event){return _vm.changeControls(1)}}},[_vm._m(3),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('MOVE')))])]),_c('div',{staticClass:\"control_btn rotate_control\",on:{\"click\":function($event){return _vm.changeControls(2)}}},[_vm._m(4),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('ROTATE')))])]),_c('div',{staticClass:\"control_btn zoomin_control\",on:{\"click\":function($event){return _vm.showChild(0)}}},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")]),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('ZOOM')))]),(_vm.showZoomOption)?_c('div',{staticClass:\"zoom_options\"},[_c('div',{staticClass:\"zoom_opt\",on:{\"click\":function($event){return _vm.zoomView(50)}}},[_vm._v(\"50%\")]),_c('div',{staticClass:\"zoom_opt\",on:{\"click\":function($event){return _vm.zoomView(100)}}},[_vm._v(\"100%\")]),_c('div',{staticClass:\"zoom_opt\",on:{\"click\":function($event){return _vm.zoomView(200)}}},[_vm._v(\"200%\")])]):_vm._e()]),_c('div',{staticClass:\"control_btn delete_control\",on:{\"click\":function($event){return _vm.deletedSelected()}}},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")]),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('DELETE')))])]),(_vm.colorControl)?_c('div',{staticClass:\"control_btn color_control_wrapper\",on:{\"click\":function($event){return _vm.showChild(1)}}},[_c('div',{staticClass:\"color_circle outside_color\",class:_vm.isWhite?'white_color_circle':''}),_c('div',{staticClass:\"btn_name\"},[_vm._v(_vm._s(_vm.$t('COLOR')))]),(_vm.showColorOption)?_c('div',{staticClass:\"color_wrapper\"},[_c('div',{staticClass:\"color_control yellow_control\",on:{\"click\":function($event){return _vm.changeCurrentColor(1)}}},[_c('div',{staticClass:\"color_circle\"})]),_c('div',{staticClass:\"color_control white_control\",on:{\"click\":function($event){return _vm.changeCurrentColor(0)}}},[_c('div',{staticClass:\"color_circle\"})])]):_vm._e()]):_vm._e()]):_vm._e()])]),(_vm.saveNmaeWindow)?_c('div',{staticClass:\"save_name_module_bg\"}):_vm._e(),(_vm.saveNmaeWindow)?_c('div',{staticClass:\"save_name_module\"},[_c('div',{staticClass:\"save_name_title\"},[_vm._v(_vm._s(_vm.$t('NAME')))]),_c('div',{staticClass:\"save_name_tip\"},[_vm._v(_vm._s(_vm.$t('NAME_MODEL')))]),_c('input',{attrs:{\"type\":\"text\",\"placeholder\":\"$t('ENTER_MODEL_NAME')\",\"maxlength\":\"14\",\"id\":\"save_name\",\"oninput\":\"saveModuleName(this,'oninput')\",\"onblur\":\"saveModuleName(this,'onblur')\",\"onFocus\":\"saveModuleName(this,'onFocus')\",\"onkeyup\":\"this.value=this.value.replace(/[^\\\\a-\\\\z\\\\A-\\\\Z0-9\\\\u4E00-\\\\u9FA5]/g ,'')\",\"blur\":\"saveModuleName(this,'blur')\"},domProps:{\"value\":this.getTimeStr()}}),_c('div',{staticClass:\"save_name_verify\"},[_vm._v(_vm._s(_vm.$t('ENTER_MODEL_NAME')))]),_c('div',{staticClass:\"btn_wrapper clearfix\"},[_c('img',{staticClass:\"save_name_ok\",attrs:{\"src\":\"/image/3dBuilder/3dPrinting/btn_yes1.png\"},on:{\"click\":function($event){_vm.activeSave?_vm.exportMoudle(0):''}}}),_c('img',{staticClass:\"imgBtn save_name_cancle\",attrs:{\"src\":\"/image/3dBuilder/3dPrinting/btn_close.png\"},on:{\"click\":function($event){return _vm.saveModuleShow(1)}}})])]):_vm._e(),(_vm.notSaveNote)?_c('div',{staticClass:\"save_ask_module_bg\"}):_vm._e(),(_vm.notSaveNote)?_c('div',{staticClass:\"save_ask\"},[_c('div',{staticClass:\"save_name_title\"},[_vm._v(_vm._s(_vm.$t('NOTE')))]),_c('div',{staticClass:\"save_name_tip\"},[_vm._v(\" \"+_vm._s(_vm.$t('SAVE_OR_NOT'))+\" \")]),_c('div',{staticClass:\"btn_wrapper clearfix\"},[_c('img',{staticClass:\"go_home_ok\",attrs:{\"src\":\"/image/3dBuilder/3dPrinting/btn_no.png\"},on:{\"click\":function($event){return _vm.goHomeSaveModule(0)}}}),_c('img',{staticClass:\"go_home_ok\",attrs:{\"src\":\"/image/3dBuilder/3dPrinting/btn_yes.png\"},on:{\"click\":function($event){return _vm.goHomeSaveModule(1)}}}),_c('img',{staticClass:\"imgBtn save_name_cancle\",attrs:{\"src\":\"/image/3dBuilder/3dPrinting/btn_close.png\"},on:{\"click\":function($event){return _vm.hideAskWindow()}}})])]):_vm._e(),_vm._m(5),(_vm.showTextWindow)?_c('div',{staticClass:\"text_window\"},[_c('div',{staticClass:\"text_title\"},[_vm._v(_vm._s(_vm.$t('GENERATE_TEXT')))]),_c('input',{attrs:{\"type\":\"text\",\"placeholder\":\"$t{'ENTER_TEXT'}\",\"maxlength\":\"10\",\"id\":\"textContent\"},on:{\"input\":_vm.textInputFn,\"blur\":_vm.textInputFn}}),_c('div',{staticClass:\"btn_wrapper clearfix\"},[_c('div',{staticClass:\"btns btn_ok text_ok\",class:_vm.inputCanConfirm?'':'btn_disable',on:{\"click\":function($event){_vm.inputCanConfirm?_vm.insertWord():null}}},[_vm._v(_vm._s(_vm.$t('CONFIRM'))+\" \")]),_c('div',{staticClass:\"btns btn_cancle text_cancle\",on:{\"click\":function($event){return _vm.showInput(1)}}},[_vm._v(_vm._s(_vm.$t('CANCEL')))])])]):_vm._e(),(_vm.controlType)?_c('div',{staticClass:\"control_type\",domProps:{\"textContent\":_vm._s(_vm.statusTxt)}},[_vm._v(_vm._s(_vm.$t('CURRENT_STATUS'))+\" \"+_vm._s(_vm.$t('MOVE')))]):_vm._e(),(_vm.showLoading)?_c('div',{class:_vm.showMore?'hideShowMore':'',attrs:{\"id\":\"loading_data\"}},[_c('img',{attrs:{\"src\":\"/image/3dBuilder/loading.gif\",\"alt\":\"\"}}),_c('div',{staticClass:\"processingbar\"},[_c('div',{staticClass:\"barwidth\",style:({width:_vm.progressingBar+'%'})})])]):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"btn_child btn_home\"},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"btn_child btn_save_module\"},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"icon_wrapper\"},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"icon_wrapper\"},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"icon_wrapper\"},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"note\"},[_c('div',{staticClass:\"select_module\"},[_vm._v(\"选择一个模型，点击 箭头按 \"),_c('span',{staticClass:\"red\"},[_vm._v(\"X\")]),_vm._v(\",\"),_c('span',{staticClass:\"green\"},[_vm._v(\"Y\")]),_vm._v(\",\"),_c('span',{staticClass:\"blue\"},[_vm._v(\"Z\")]),_vm._v(\"单向缩放,点击中心方块或 者双指，进行整体 缩放 \")])])}]\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeDimensionalBuilder.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeDimensionalBuilder.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ThreeDimensionalBuilder.vue?vue&type=template&id=7c8a8f6c&scoped=true&\"\nimport script from \"./ThreeDimensionalBuilder.vue?vue&type=script&lang=js&\"\nexport * from \"./ThreeDimensionalBuilder.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ThreeDimensionalBuilder.vue?vue&type=style&index=0&id=7c8a8f6c&scoped=true&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7c8a8f6c\",\n  null\n  \n)\n\nexport default component.exports","import {\r\n\tBoxBufferGeometry,\r\n\tBufferGeometry,\r\n\tColor,\r\n\tCylinderBufferGeometry,\r\n\tDoubleSide,\r\n\tEuler,\r\n\tFloat32BufferAttribute,\r\n\tLine,\r\n\tLineBasicMaterial,\r\n\tMatrix4,\r\n\tMesh,\r\n\tMeshBasicMaterial,\r\n\tObject3D,\r\n\tOctahedronBufferGeometry,\r\n\tPlaneBufferGeometry,\r\n\tQuaternion,\r\n\tRaycaster,\r\n\tSphereBufferGeometry,\r\n\tTorusBufferGeometry,\r\n\tVector3\r\n} from 'three/build/three.module.js';\r\n\r\nvar TransformControls = function ( camera, domElement ) {\r\n\r\n\tif ( domElement === undefined ) {\r\n\r\n\t\tconsole.warn( 'THREE.TransformControls: The second parameter \"domElement\" is now mandatory.' );\r\n\t\tdomElement = document;\r\n\r\n\t}\r\n\r\n\tObject3D.call( this );\r\n\r\n\tthis.visible = false;\r\n\tthis.domElement = domElement;\r\n\r\n\tvar _gizmo = new TransformControlsGizmo();\r\n\tthis.add( _gizmo );\r\n\r\n\tvar _plane = new TransformControlsPlane();\r\n\tthis.add( _plane );\r\n\r\n\tvar scope = this;\r\n\r\n\t// Define properties with getters/setter\r\n\t// Setting the defined property will automatically trigger change event\r\n\t// Defined properties are passed down to gizmo and plane\r\n\r\n\tdefineProperty( 'camera', camera );\r\n\tdefineProperty( 'object', undefined );\r\n\tdefineProperty( 'enabled', true );\r\n\tdefineProperty( 'axis', null );\r\n\tdefineProperty( 'mode', 'translate' );\r\n\tdefineProperty( 'translationSnap', null );\r\n\tdefineProperty( 'rotationSnap', null );\r\n\tdefineProperty( 'scaleSnap', null );\r\n\tdefineProperty( 'space', 'world' );\r\n\tdefineProperty( 'size', 1 );\r\n\tdefineProperty( 'dragging', false );\r\n\tdefineProperty( 'showX', true );\r\n\tdefineProperty( 'showY', true );\r\n\tdefineProperty( 'showZ', true );\r\n\r\n\tvar changeEvent = { type: 'change' };\r\n\tvar mouseDownEvent = { type: 'mouseDown' };\r\n\tvar mouseUpEvent = { type: 'mouseUp', mode: scope.mode };\r\n\tvar objectChangeEvent = { type: 'objectChange' };\r\n\r\n\t// Reusable utility variables\r\n\r\n\tvar raycaster = new Raycaster();\r\n\r\n\tfunction intersectObjectWithRay( object, raycaster, includeInvisible ) {\r\n\r\n\t\tvar allIntersections = raycaster.intersectObject( object, true );\r\n\r\n\t\tfor ( var i = 0; i < allIntersections.length; i ++ ) {\r\n\r\n\t\t\tif ( allIntersections[ i ].object.visible || includeInvisible ) {\r\n\r\n\t\t\t\treturn allIntersections[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tvar _tempVector = new Vector3();\r\n\tvar _tempVector2 = new Vector3();\r\n\tvar _tempQuaternion = new Quaternion();\r\n\tvar _unit = {\r\n\t\tX: new Vector3( 1, 0, 0 ),\r\n\t\tY: new Vector3( 0, 1, 0 ),\r\n\t\tZ: new Vector3( 0, 0, 1 )\r\n\t};\r\n\r\n\tvar pointStart = new Vector3();\r\n\tvar pointEnd = new Vector3();\r\n\tvar offset = new Vector3();\r\n\tvar rotationAxis = new Vector3();\r\n\tvar startNorm = new Vector3();\r\n\tvar endNorm = new Vector3();\r\n\tvar rotationAngle = 0;\r\n\r\n\tvar cameraPosition = new Vector3();\r\n\tvar cameraQuaternion = new Quaternion();\r\n\tvar cameraScale = new Vector3();\r\n\r\n\tvar parentPosition = new Vector3();\r\n\tvar parentQuaternion = new Quaternion();\r\n\tvar parentQuaternionInv = new Quaternion();\r\n\tvar parentScale = new Vector3();\r\n\r\n\tvar worldPositionStart = new Vector3();\r\n\tvar worldQuaternionStart = new Quaternion();\r\n\tvar worldScaleStart = new Vector3();\r\n\r\n\tvar worldPosition = new Vector3();\r\n\tvar worldQuaternion = new Quaternion();\r\n\tvar worldQuaternionInv = new Quaternion();\r\n\tvar worldScale = new Vector3();\r\n\r\n\tvar eye = new Vector3();\r\n\r\n\tvar positionStart = new Vector3();\r\n\tvar quaternionStart = new Quaternion();\r\n\tvar scaleStart = new Vector3();\r\n\r\n\t// TODO: remove properties unused in plane and gizmo\r\n\r\n\tdefineProperty( 'worldPosition', worldPosition );\r\n\tdefineProperty( 'worldPositionStart', worldPositionStart );\r\n\tdefineProperty( 'worldQuaternion', worldQuaternion );\r\n\tdefineProperty( 'worldQuaternionStart', worldQuaternionStart );\r\n\tdefineProperty( 'cameraPosition', cameraPosition );\r\n\tdefineProperty( 'cameraQuaternion', cameraQuaternion );\r\n\tdefineProperty( 'pointStart', pointStart );\r\n\tdefineProperty( 'pointEnd', pointEnd );\r\n\tdefineProperty( 'rotationAxis', rotationAxis );\r\n\tdefineProperty( 'rotationAngle', rotationAngle );\r\n\tdefineProperty( 'eye', eye );\r\n\r\n\t{\r\n\r\n\t\tdomElement.addEventListener( 'pointerdown', onPointerDown, false );\r\n\t\tdomElement.addEventListener( 'pointermove', onPointerHover, false );\r\n\t\tscope.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp, false );\r\n\r\n\t}\r\n\r\n\tthis.dispose = function () {\r\n\r\n\t\tdomElement.removeEventListener( 'pointerdown', onPointerDown );\r\n\t\tdomElement.removeEventListener( 'pointermove', onPointerHover );\r\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\r\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\r\n\r\n\t\tthis.traverse( function ( child ) {\r\n\r\n\t\t\tif ( child.geometry ) child.geometry.dispose();\r\n\t\t\tif ( child.material ) child.material.dispose();\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\t// Set current object\r\n\t/*this.attach = function ( object ) {\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.visible = true;\r\n\r\n\t\treturn this;\r\n\r\n\t};*/\r\n\tthis.attach = function ( object ) {\r\n\t\tvar activelength = $(\".active_control\").length;\r\n\t\tif(object && object.name!='plane'){ //plane不可被选中移动\r\n\t\t\tthis.object = object;\r\n\t\t\tthis.visible = true;\r\n\t\t\t// eslint-disable-next-line no-undef\r\n\t\t\twindow.focusedTransformObj = object;\r\n\t\t\t// eslint-disable-next-line no-undef\r\n\t\t\tconsole.log(\"window.deleteObjFlag::\"+window.deleteObjFlag)\r\n\t\t\twindow.deleteObjFlag = false;\r\n\t\t\t$(\".color_control_wrapper\").show();\r\n\t\t\t$(\".active_control\").removeClass(\"active_control\");\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tswitch(scope.mode){\r\n\t\t\t\t\tcase \"scale\":\r\n\t\t\t\t\t\t$('.size_control').addClass(\"active_control\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"translate\":\r\n\t\t\t\t\t\t$('.trans_control').addClass(\"active_control\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rotate\":\r\n\t\t\t\t\t\t$('.rotate_control').addClass(\"active_control\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},0)\r\n\t\t}\r\n\t\telse{\r\n\t\t\t// eslint-disable-next-line no-undef\r\n\t\t\tif(window.focusedTransformObj && activelength>0){\r\n\t\t\t\t// eslint-disable-next-line no-undef\r\n\t\t\t\tthis.object = window.focusedTransformObj;\r\n\t\t\t\tthis.visible = true;\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t$(\".color_control_wrapper\").hide();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\t// Detatch from object\r\n\tthis.detach = function () {\r\n\r\n\t\tthis.object = undefined;\r\n\t\tthis.visible = false;\r\n\t\tthis.axis = null;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t// Defined getter, setter and store for a property\r\n\tfunction defineProperty( propName, defaultValue ) {\r\n\r\n\t\tvar propValue = defaultValue;\r\n\r\n\t\tObject.defineProperty( scope, propName, {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn propValue !== undefined ? propValue : defaultValue;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tif ( propValue !== value ) {\r\n\r\n\t\t\t\t\tpropValue = value;\r\n\t\t\t\t\t_plane[ propName ] = value;\r\n\t\t\t\t\t_gizmo[ propName ] = value;\r\n\r\n\t\t\t\t\tscope.dispatchEvent( { type: propName + '-changed', value: value } );\r\n\t\t\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\tscope[ propName ] = defaultValue;\r\n\t\t_plane[ propName ] = defaultValue;\r\n\t\t_gizmo[ propName ] = defaultValue;\r\n\r\n\t}\r\n\r\n\t// updateMatrixWorld  updates key transformation variables\r\n\tthis.updateMatrixWorld = function () {\r\n\r\n\t\tif ( this.object !== undefined ) {\r\n\r\n\t\t\tthis.object.updateMatrixWorld();\r\n\r\n\t\t\tif ( this.object.parent === null ) {\r\n\r\n\t\t\t\tconsole.error( 'TransformControls: The attached 3D object must be a part of the scene graph.' );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\r\n\r\n\t\t\tparentQuaternionInv.copy( parentQuaternion ).invert();\r\n\t\t\tworldQuaternionInv.copy( worldQuaternion ).invert();\r\n\r\n\t\t}\r\n\r\n\t\tthis.camera.updateMatrixWorld();\r\n\t\tthis.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\r\n\r\n\t\teye.copy( cameraPosition ).sub( worldPosition ).normalize();\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\r\n\r\n\t};\r\n\r\n\tthis.pointerHover = function ( pointer ) {\r\n\r\n\t\tif ( this.object === undefined || this.dragging === true ) return;\r\n\r\n\t\traycaster.setFromCamera( pointer, this.camera );\r\n\r\n\t\tvar intersect = intersectObjectWithRay( _gizmo.picker[ this.mode ], raycaster );\r\n\r\n\t\tif ( intersect ) {\r\n\r\n\t\t\tthis.axis = intersect.object.name;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.axis = null;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.pointerDown = function ( pointer ) {\r\n\r\n\t\tif ( this.object === undefined || this.dragging === true || pointer.button !== 0 ) return;\r\n\r\n\t\tif ( this.axis !== null ) {\r\n\r\n\t\t\traycaster.setFromCamera( pointer, this.camera );\r\n\r\n\t\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\r\n\r\n\t\t\tif ( planeIntersect ) {\r\n\r\n\t\t\t\tvar space = this.space;\r\n\r\n\t\t\t\tif ( this.mode === 'scale' ) {\r\n\r\n\t\t\t\t\tspace = 'local';\r\n\r\n\t\t\t\t} else if ( this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ' ) {\r\n\r\n\t\t\t\t\tspace = 'world';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( space === 'local' && this.mode === 'rotate' ) {\r\n\r\n\t\t\t\t\tvar snap = this.rotationSnap;\r\n\r\n\t\t\t\t\tif ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\r\n\t\t\t\t\tif ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\r\n\t\t\t\t\tif ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.object.updateMatrixWorld();\r\n\t\t\t\tthis.object.parent.updateMatrixWorld();\r\n\r\n\t\t\t\tpositionStart.copy( this.object.position );\r\n\t\t\t\tquaternionStart.copy( this.object.quaternion );\r\n\t\t\t\tscaleStart.copy( this.object.scale );\r\n\r\n\t\t\t\tthis.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\r\n\r\n\t\t\t\tpointStart.copy( planeIntersect.point ).sub( worldPositionStart );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.dragging = true;\r\n\t\t\tmouseDownEvent.mode = this.mode;\r\n\t\t\tthis.dispatchEvent( mouseDownEvent );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.pointerMove = function ( pointer ) {\r\n\r\n\t\tvar axis = this.axis;\r\n\t\tvar mode = this.mode;\r\n\t\tvar object = this.object;\r\n\t\tvar space = this.space;\r\n\r\n\t\tif ( mode === 'scale' ) {\r\n\r\n\t\t\tspace = 'local';\r\n\r\n\t\t} else if ( axis === 'E' || axis === 'XYZE' || axis === 'XYZ' ) {\r\n\r\n\t\t\tspace = 'world';\r\n\r\n\t\t}\r\n\r\n\t\tif ( object === undefined || axis === null || this.dragging === false || pointer.button !== - 1 ) return;\r\n\r\n\t\traycaster.setFromCamera( pointer, this.camera );\r\n\r\n\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\r\n\r\n\t\tif ( ! planeIntersect ) return;\r\n\r\n\t\tpointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\r\n\r\n\t\tif ( mode === 'translate' ) {\r\n\r\n\t\t\t// Apply translate\r\n\r\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\r\n\r\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\r\n\r\n\t\t\t\toffset.applyQuaternion( worldQuaternionInv );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis.indexOf( 'X' ) === - 1 ) offset.x = 0;\r\n\t\t\tif ( axis.indexOf( 'Y' ) === - 1 ) offset.y = 0;\r\n\t\t\tif ( axis.indexOf( 'Z' ) === - 1 ) offset.z = 0;\r\n\r\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\r\n\r\n\t\t\t\toffset.applyQuaternion( quaternionStart ).divide( parentScale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\toffset.applyQuaternion( parentQuaternionInv ).divide( parentScale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.position.copy( offset ).add( positionStart );\r\n\r\n\t\t\t// Apply translation snap\r\n\r\n\t\t\tif ( this.translationSnap ) {\r\n\r\n\t\t\t\tif ( space === 'local' ) {\r\n\r\n\t\t\t\t\tobject.position.applyQuaternion( _tempQuaternion.copy( quaternionStart ).invert() );\r\n\r\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobject.position.applyQuaternion( quaternionStart );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( space === 'world' ) {\r\n\r\n\t\t\t\t\tif ( object.parent ) {\r\n\r\n\t\t\t\t\t\tobject.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( object.parent ) {\r\n\r\n\t\t\t\t\t\tobject.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( mode === 'scale' ) {\r\n\r\n\t\t\tif ( axis.search( 'XYZ' ) !== - 1 ) {\r\n\r\n\t\t\t\tvar d = pointEnd.length() / pointStart.length();\r\n\r\n\t\t\t\tif ( pointEnd.dot( pointStart ) < 0 ) d *= - 1;\r\n\r\n\t\t\t\t_tempVector2.set( d, d, d );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_tempVector.copy( pointStart );\r\n\t\t\t\t_tempVector2.copy( pointEnd );\r\n\r\n\t\t\t\t_tempVector.applyQuaternion( worldQuaternionInv );\r\n\t\t\t\t_tempVector2.applyQuaternion( worldQuaternionInv );\r\n\r\n\t\t\t\t_tempVector2.divide( _tempVector );\r\n\r\n\t\t\t\tif ( axis.search( 'X' ) === - 1 ) {\r\n\r\n\t\t\t\t\t_tempVector2.x = 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Y' ) === - 1 ) {\r\n\r\n\t\t\t\t\t_tempVector2.y = 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Z' ) === - 1 ) {\r\n\r\n\t\t\t\t\t_tempVector2.z = 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Apply scale\r\n\r\n\t\t\tobject.scale.copy( scaleStart ).multiply( _tempVector2 );\r\n\r\n\t\t\tif ( this.scaleSnap ) {\r\n\r\n\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tobject.scale.x = Math.round( object.scale.x / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tobject.scale.y = Math.round( object.scale.y / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tobject.scale.z = Math.round( object.scale.z / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( mode === 'rotate' ) {\r\n\r\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\r\n\r\n\t\t\tvar ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\r\n\r\n\t\t\tif ( axis === 'E' ) {\r\n\r\n\t\t\t\trotationAxis.copy( eye );\r\n\t\t\t\trotationAngle = pointEnd.angleTo( pointStart );\r\n\r\n\t\t\t\tstartNorm.copy( pointStart ).normalize();\r\n\t\t\t\tendNorm.copy( pointEnd ).normalize();\r\n\r\n\t\t\t\trotationAngle *= ( endNorm.cross( startNorm ).dot( eye ) < 0 ? 1 : - 1 );\r\n\r\n\t\t\t} else if ( axis === 'XYZE' ) {\r\n\r\n\t\t\t\trotationAxis.copy( offset ).cross( eye ).normalize();\r\n\t\t\t\trotationAngle = offset.dot( _tempVector.copy( rotationAxis ).cross( this.eye ) ) * ROTATION_SPEED;\r\n\r\n\t\t\t} else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\r\n\r\n\t\t\t\trotationAxis.copy( _unit[ axis ] );\r\n\r\n\t\t\t\t_tempVector.copy( _unit[ axis ] );\r\n\r\n\t\t\t\tif ( space === 'local' ) {\r\n\r\n\t\t\t\t\t_tempVector.applyQuaternion( worldQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\trotationAngle = offset.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Apply rotation snap\r\n\r\n\t\t\tif ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\r\n\r\n\t\t\tthis.rotationAngle = rotationAngle;\r\n\r\n\t\t\t// Apply rotate\r\n\t\t\tif ( space === 'local' && axis !== 'E' && axis !== 'XYZE' ) {\r\n\r\n\t\t\t\tobject.quaternion.copy( quaternionStart );\r\n\t\t\t\tobject.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) ).normalize();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trotationAxis.applyQuaternion( parentQuaternionInv );\r\n\t\t\t\tobject.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\r\n\t\t\t\tobject.quaternion.multiply( quaternionStart ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.dispatchEvent( changeEvent );\r\n\t\tthis.dispatchEvent( objectChangeEvent );\r\n\r\n\t};\r\n\r\n\tthis.pointerUp = function ( pointer ) {\r\n\r\n\t\tif ( pointer.button !== 0 ) return;\r\n\r\n\t\tif ( this.dragging && ( this.axis !== null ) ) {\r\n\r\n\t\t\tmouseUpEvent.mode = this.mode;\r\n\t\t\tthis.dispatchEvent( mouseUpEvent );\r\n\r\n\t\t}\r\n\r\n\t\tthis.dragging = false;\r\n\t\tthis.axis = null;\r\n\r\n\t};\r\n\r\n\t// normalize mouse / touch pointer and remap {x,y} to view space.\r\n\r\n\tfunction getPointer( event ) {\r\n\r\n\t\tif ( scope.domElement.ownerDocument.pointerLockElement ) {\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\tbutton: event.button\r\n\t\t\t};\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\r\n\r\n\t\t\tvar rect = domElement.getBoundingClientRect();\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\r\n\t\t\t\ty: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\r\n\t\t\t\tbutton: event.button\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// mouse / touch event handlers\r\n\r\n\tfunction onPointerHover( event ) {\r\n\r\n\t\tif ( ! scope.enabled ) return;\r\n\r\n\t\tswitch ( event.pointerType ) {\r\n\r\n\t\t\tcase 'mouse':\r\n\t\t\tcase 'pen':\r\n\t\t\t\tscope.pointerHover( getPointer( event ) );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onPointerDown( event ) {\r\n\r\n\t\tif ( ! scope.enabled ) return;\r\n\r\n\t\tscope.domElement.style.touchAction = 'none'; // disable touch scroll\r\n\t\tscope.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove, false );\r\n\r\n\t\tscope.pointerHover( getPointer( event ) );\r\n\t\tscope.pointerDown( getPointer( event ) );\r\n\r\n\t}\r\n\r\n\tfunction onPointerMove( event ) {\r\n\r\n\t\tif ( ! scope.enabled ) return;\r\n\r\n\t\tscope.pointerMove( getPointer( event ) );\r\n\r\n\t}\r\n\r\n\tfunction onPointerUp( event ) {\r\n\r\n\t\tif ( ! scope.enabled ) return;\r\n\r\n\t\tscope.domElement.style.touchAction = '';\r\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove, false );\r\n\r\n\t\tscope.pointerUp( getPointer( event ) );\r\n\r\n\t}\r\n\r\n\t// TODO: deprecate\r\n\r\n\tthis.getMode = function () {\r\n\r\n\t\treturn scope.mode;\r\n\r\n\t};\r\n\r\n\tthis.setMode = function ( mode ) {\r\n\r\n\t\tscope.mode = mode;\r\n\r\n\t};\r\n\r\n\tthis.setTranslationSnap = function ( translationSnap ) {\r\n\r\n\t\tscope.translationSnap = translationSnap;\r\n\r\n\t};\r\n\r\n\tthis.setRotationSnap = function ( rotationSnap ) {\r\n\r\n\t\tscope.rotationSnap = rotationSnap;\r\n\r\n\t};\r\n\r\n\tthis.setScaleSnap = function ( scaleSnap ) {\r\n\r\n\t\tscope.scaleSnap = scaleSnap;\r\n\r\n\t};\r\n\r\n\tthis.setSize = function ( size ) {\r\n\r\n\t\tscope.size = size;\r\n\r\n\t};\r\n\r\n\tthis.setSpace = function ( space ) {\r\n\r\n\t\tscope.space = space;\r\n\r\n\t};\r\n\r\n\tthis.update = function () {\r\n\r\n\t\tconsole.warn( 'THREE.TransformControls: update function has no more functionality and therefore has been deprecated.' );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTransformControls.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\tconstructor: TransformControls,\r\n\r\n\tisTransformControls: true\r\n\r\n} );\r\n\r\n\r\nvar TransformControlsGizmo = function () {\r\n\r\n\t'use strict';\r\n\r\n\tObject3D.call( this );\r\n\r\n\tthis.type = 'TransformControlsGizmo';\r\n\r\n\t// shared materials\r\n\r\n\tvar gizmoMaterial = new MeshBasicMaterial( {\r\n\t\tdepthTest: false,\r\n\t\tdepthWrite: false,\r\n\t\ttransparent: true,\r\n\t\tside: DoubleSide,\r\n\t\tfog: false,\r\n\t\ttoneMapped: false\r\n\t} );\r\n\r\n\tvar gizmoLineMaterial = new LineBasicMaterial( {\r\n\t\tdepthTest: false,\r\n\t\tdepthWrite: false,\r\n\t\ttransparent: true,\r\n\t\tlinewidth: 1,\r\n\t\tfog: false,\r\n\t\ttoneMapped: false\r\n\t} );\r\n\r\n\t// Make unique material for each axis/color\r\n\r\n\tvar matInvisible = gizmoMaterial.clone();\r\n\tmatInvisible.opacity = 0.15;\r\n\r\n\tvar matHelper = gizmoMaterial.clone();\r\n\tmatHelper.opacity = 0.33;\r\n\r\n\tvar matRed = gizmoMaterial.clone();\r\n\tmatRed.color.set( 0xff0000 );\r\n\r\n\tvar matGreen = gizmoMaterial.clone();\r\n\tmatGreen.color.set( 0x00ff00 );\r\n\r\n\tvar matBlue = gizmoMaterial.clone();\r\n\tmatBlue.color.set( 0x0000ff );\r\n\r\n\tvar matWhiteTransparent = gizmoMaterial.clone();\r\n\tmatWhiteTransparent.opacity = 0.25;\r\n\r\n\tvar matYellowTransparent = matWhiteTransparent.clone();\r\n\tmatYellowTransparent.color.set( 0xffff00 );\r\n\r\n\tvar matCyanTransparent = matWhiteTransparent.clone();\r\n\tmatCyanTransparent.color.set( 0x00ffff );\r\n\r\n\tvar matMagentaTransparent = matWhiteTransparent.clone();\r\n\tmatMagentaTransparent.color.set( 0xff00ff );\r\n\r\n\tvar matYellow = gizmoMaterial.clone();\r\n\tmatYellow.color.set( 0xffff00 );\r\n\r\n\tvar matLineRed = gizmoLineMaterial.clone();\r\n\tmatLineRed.color.set( 0xff0000 );\r\n\r\n\tvar matLineGreen = gizmoLineMaterial.clone();\r\n\tmatLineGreen.color.set( 0x00ff00 );\r\n\r\n\tvar matLineBlue = gizmoLineMaterial.clone();\r\n\tmatLineBlue.color.set( 0x0000ff );\r\n\r\n\tvar matLineCyan = gizmoLineMaterial.clone();\r\n\tmatLineCyan.color.set( 0x00ffff );\r\n\r\n\tvar matLineMagenta = gizmoLineMaterial.clone();\r\n\tmatLineMagenta.color.set( 0xff00ff );\r\n\r\n\tvar matLineYellow = gizmoLineMaterial.clone();\r\n\tmatLineYellow.color.set( 0xffff00 );\r\n\r\n\tvar matLineGray = gizmoLineMaterial.clone();\r\n\tmatLineGray.color.set( 0x787878 );\r\n\r\n\tvar matLineYellowTransparent = matLineYellow.clone();\r\n\tmatLineYellowTransparent.opacity = 0.5;\r\n\r\n\t// reusable geometry\r\n\r\n\tvar arrowGeometry = new CylinderBufferGeometry( 0, 0.1, 0.2, 12, 1, false );\r\n\r\n\tvar scaleHandleGeometry = new BoxBufferGeometry( 0.2, 0.2, 0.2 );\r\n\r\n\tvar lineGeometry = new BufferGeometry();\r\n\tlineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\r\n\r\n\tvar CircleGeometry = function ( radius, arc ) {\r\n\r\n\t\tvar geometry = new BufferGeometry( );\r\n\t\tvar vertices = [];\r\n\r\n\t\tfor ( var i = 0; i <= 64 * arc; ++ i ) {\r\n\r\n\t\t\tvertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\r\n\t\treturn geometry;\r\n\r\n\t};\r\n\r\n\t// Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\r\n\r\n\tvar TranslateHelperGeometry = function () {\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\r\n\r\n\t\treturn geometry;\r\n\r\n\t};\r\n\r\n\t// Gizmo definitions - custom hierarchy definitions for setupGizmo() function\r\n\r\n\tvar gizmoTranslate = {\r\n\t\tX: [\r\n\t\t\t[ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, - Math.PI / 2 ], null, 'fwd' ],\r\n\t\t\t[ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\r\n\t\t\t[ new Line( lineGeometry, matLineRed ) ]\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\r\n\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\r\n\t\t\t[ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ]]\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\r\n\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ - Math.PI / 2, 0, 0 ], null, 'bwd' ],\r\n\t\t\t[ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ]]\r\n\t\t],\r\n\t\tXYZ: [\r\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransparent.clone() ), [ 0, 0, 0 ], [ 0, 0, 0 ]]\r\n\t\t],\r\n\t\tXY: [\r\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent.clone() ), [ 0.15, 0.15, 0 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\r\n\t\t],\r\n\t\tYZ: [\r\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent.clone() ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\r\n\t\t],\r\n\t\tXZ: [\r\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent.clone() ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\r\n\t\t]\r\n\t};\r\n\r\n\tvar pickerTranslate = {\r\n\t\tX: [\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ]]\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ]]\r\n\t\t],\r\n\t\tXYZ: [\r\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\r\n\t\t],\r\n\t\tXY: [\r\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ]]\r\n\t\t],\r\n\t\tYZ: [\r\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ]]\r\n\t\t],\r\n\t\tXZ: [\r\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ - Math.PI / 2, 0, 0 ]]\r\n\t\t]\r\n\t};\r\n\r\n\tvar helperTranslate = {\r\n\t\tSTART: [\r\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\r\n\t\t],\r\n\t\tEND: [\r\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\r\n\t\t],\r\n\t\tDELTA: [\r\n\t\t\t[ new Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\r\n\t\t],\r\n\t\tX: [\r\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t]\r\n\t};\r\n\r\n\tvar gizmoRotate = {\r\n\t\tX: [\r\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\r\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ]],\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ]],\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ]],\r\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ]],\r\n\t\t],\r\n\t\tE: [\r\n\t\t\t[ new Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ]],\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, - Math.PI / 2 ], [ 1, 1, 0.001 ]],\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ - 1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, - 1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\r\n\t\t],\r\n\t\tXYZE: [\r\n\t\t\t[ new Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ]]\r\n\t\t]\r\n\t};\r\n\r\n\tvar helperRotate = {\r\n\t\tAXIS: [\r\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t]\r\n\t};\r\n\r\n\tvar pickerRotate = {\r\n\t\tX: [\r\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, - Math.PI / 2, - Math.PI / 2 ]],\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t],\r\n\t\tE: [\r\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\r\n\t\t],\r\n\t\tXYZE: [\r\n\t\t\t[ new Mesh( new SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\r\n\t\t]\r\n\t};\r\n\r\n\tvar gizmoScale = {\r\n\t\tX: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ]]\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ]]\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ], [ 0.8, 1, 1 ]]\r\n\t\t]/*,\r\n\t\tXY: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\r\n\t\t],\r\n\t\tYZ: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\r\n\t\t],\r\n\t\tXZ: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ]],\r\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\r\n\t\t],\r\n\t\tXYZX: [\r\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 1.1, 0, 0 ]],\r\n\t\t],\r\n\t\tXYZY: [\r\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 1.1, 0 ]],\r\n\t\t],\r\n\t\tXYZZ: [\r\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 0, 1.1 ]],\r\n\t\t]*/\r\n\t};\r\n\r\n\tvar pickerScale = {\r\n\t\tX: [\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ]]\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ]]\r\n\t\t]/*,\r\n\t\tXY: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ]],\r\n\t\t],\r\n\t\tYZ: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ]],\r\n\t\t],\r\n\t\tXZ: [\r\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ]],\r\n\t\t],\r\n\t\tXYZX: [\r\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ]],\r\n\t\t],\r\n\t\tXYZY: [\r\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ]],\r\n\t\t],\r\n\t\tXYZZ: [\r\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ]],\r\n\t\t]*/\r\n\t};\r\n\r\n\tvar helperScale = {\r\n\t\tX: [\r\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t],\r\n\t\tY: [\r\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t],\r\n\t\tZ: [\r\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t]\r\n\t};\r\n\r\n\t// Creates an Object3D with gizmos described in custom hierarchy definition.\r\n\r\n\tvar setupGizmo = function ( gizmoMap ) {\r\n\r\n\t\tvar gizmo = new Object3D();\r\n\r\n\t\tfor ( var name in gizmoMap ) {\r\n\r\n\t\t\tfor ( var i = gizmoMap[ name ].length; i --; ) {\r\n\r\n\t\t\t\tvar object = gizmoMap[ name ][ i ][ 0 ].clone();\r\n\t\t\t\tvar position = gizmoMap[ name ][ i ][ 1 ];\r\n\t\t\t\tvar rotation = gizmoMap[ name ][ i ][ 2 ];\r\n\t\t\t\tvar scale = gizmoMap[ name ][ i ][ 3 ];\r\n\t\t\t\tvar tag = gizmoMap[ name ][ i ][ 4 ];\r\n\r\n\t\t\t\t// name and tag properties are essential for picking and updating logic.\r\n\t\t\t\tobject.name = name;\r\n\t\t\t\tobject.tag = tag;\r\n\r\n\t\t\t\tif ( position ) {\r\n\r\n\t\t\t\t\tobject.position.set( position[ 0 ], position[ 1 ], position[ 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( rotation ) {\r\n\r\n\t\t\t\t\tobject.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( scale ) {\r\n\r\n\t\t\t\t\tobject.scale.set( scale[ 0 ], scale[ 1 ], scale[ 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobject.updateMatrix();\r\n\r\n\t\t\t\tvar tempGeometry = object.geometry.clone();\r\n\t\t\t\ttempGeometry.applyMatrix4( object.matrix );\r\n\t\t\t\tobject.geometry = tempGeometry;\r\n\t\t\t\tobject.renderOrder = Infinity;\r\n\r\n\t\t\t\tobject.position.set( 0, 0, 0 );\r\n\t\t\t\tobject.rotation.set( 0, 0, 0 );\r\n\t\t\t\tobject.scale.set( 1, 1, 1 );\r\n\r\n\t\t\t\tgizmo.add( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn gizmo;\r\n\r\n\t};\r\n\r\n\t// Reusable utility variables\r\n\r\n\tvar tempVector = new Vector3( 0, 0, 0 );\r\n\tvar tempEuler = new Euler();\r\n\tvar alignVector = new Vector3( 0, 1, 0 );\r\n\tvar zeroVector = new Vector3( 0, 0, 0 );\r\n\tvar lookAtMatrix = new Matrix4();\r\n\tvar tempQuaternion = new Quaternion();\r\n\tvar tempQuaternion2 = new Quaternion();\r\n\tvar identityQuaternion = new Quaternion();\r\n\r\n\tvar unitX = new Vector3( 1, 0, 0 );\r\n\tvar unitY = new Vector3( 0, 1, 0 );\r\n\tvar unitZ = new Vector3( 0, 0, 1 );\r\n\r\n\t// Gizmo creation\r\n\r\n\tthis.gizmo = {};\r\n\tthis.picker = {};\r\n\tthis.helper = {};\r\n\r\n\tthis.add( this.gizmo[ 'translate' ] = setupGizmo( gizmoTranslate ) );\r\n\tthis.add( this.gizmo[ 'rotate' ] = setupGizmo( gizmoRotate ) );\r\n\tthis.add( this.gizmo[ 'scale' ] = setupGizmo( gizmoScale ) );\r\n\tthis.add( this.picker[ 'translate' ] = setupGizmo( pickerTranslate ) );\r\n\tthis.add( this.picker[ 'rotate' ] = setupGizmo( pickerRotate ) );\r\n\tthis.add( this.picker[ 'scale' ] = setupGizmo( pickerScale ) );\r\n\tthis.add( this.helper[ 'translate' ] = setupGizmo( helperTranslate ) );\r\n\tthis.add( this.helper[ 'rotate' ] = setupGizmo( helperRotate ) );\r\n\tthis.add( this.helper[ 'scale' ] = setupGizmo( helperScale ) );\r\n\r\n\t// Pickers should be hidden always\r\n\r\n\tthis.picker[ 'translate' ].visible = false;\r\n\tthis.picker[ 'rotate' ].visible = false;\r\n\tthis.picker[ 'scale' ].visible = false;\r\n\r\n\t// updateMatrixWorld will update transformations and appearance of individual handles\r\n\r\n\tthis.updateMatrixWorld = function () {\r\n\r\n\t\tvar space = this.space;\r\n\r\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\r\n\r\n\t\tvar quaternion = space === 'local' ? this.worldQuaternion : identityQuaternion;\r\n\r\n\t\t// Show only gizmos for current transform mode\r\n\r\n\t\tthis.gizmo[ 'translate' ].visible = this.mode === 'translate';\r\n\t\tthis.gizmo[ 'rotate' ].visible = this.mode === 'rotate';\r\n\t\tthis.gizmo[ 'scale' ].visible = this.mode === 'scale';\r\n\r\n\t\tthis.helper[ 'translate' ].visible = this.mode === 'translate';\r\n\t\tthis.helper[ 'rotate' ].visible = this.mode === 'rotate';\r\n\t\tthis.helper[ 'scale' ].visible = this.mode === 'scale';\r\n\r\n\r\n\t\tvar handles = [];\r\n\t\thandles = handles.concat( this.picker[ this.mode ].children );\r\n\t\thandles = handles.concat( this.gizmo[ this.mode ].children );\r\n\t\thandles = handles.concat( this.helper[ this.mode ].children );\r\n\r\n\t\tfor ( var i = 0; i < handles.length; i ++ ) {\r\n\r\n\t\t\tvar handle = handles[ i ];\r\n\r\n\t\t\t// hide aligned to camera\r\n\r\n\t\t\thandle.visible = true;\r\n\t\t\thandle.rotation.set( 0, 0, 0 );\r\n\t\t\thandle.position.copy( this.worldPosition );\r\n\r\n\t\t\tvar factor;\r\n\r\n\t\t\tif ( this.camera.isOrthographicCamera ) {\r\n\r\n\t\t\t\tfactor = ( this.camera.top - this.camera.bottom ) / this.camera.zoom;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfactor = this.worldPosition.distanceTo( this.cameraPosition ) * Math.min( 1.9 * Math.tan( Math.PI * this.camera.fov / 360 ) / this.camera.zoom, 7 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\thandle.scale.set( 1, 1, 1 ).multiplyScalar( factor * this.size / 7 );\r\n\r\n\t\t\t// TODO: simplify helpers and consider decoupling from gizmo\r\n\r\n\t\t\tif ( handle.tag === 'helper' ) {\r\n\r\n\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\tif ( handle.name === 'AXIS' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\t\t\t\t\thandle.visible = !! this.axis;\r\n\r\n\t\t\t\t\tif ( this.axis === 'X' ) {\r\n\r\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\r\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\r\n\r\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'Y' ) {\r\n\r\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\r\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\r\n\r\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'Z' ) {\r\n\r\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\r\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\r\n\r\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'XYZE' ) {\r\n\r\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\r\n\t\t\t\t\t\talignVector.copy( this.rotationAxis );\r\n\t\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\r\n\t\t\t\t\t\thandle.quaternion.multiply( tempQuaternion );\r\n\t\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'E' ) {\r\n\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t} else if ( handle.name === 'START' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t} else if ( handle.name === 'END' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPosition );\r\n\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t} else if ( handle.name === 'DELTA' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\t\t\t\t\thandle.quaternion.copy( this.worldQuaternionStart );\r\n\t\t\t\t\ttempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( - 1 );\r\n\t\t\t\t\ttempVector.applyQuaternion( this.worldQuaternionStart.clone().invert() );\r\n\t\t\t\t\thandle.scale.copy( tempVector );\r\n\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thandle.quaternion.copy( quaternion );\r\n\r\n\t\t\t\t\tif ( this.dragging ) {\r\n\r\n\t\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\thandle.position.copy( this.worldPosition );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis ) {\r\n\r\n\t\t\t\t\t\thandle.visible = this.axis.search( handle.name ) !== - 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If updating helper, skip rest of the loop\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Align handles to current local or world rotation\r\n\r\n\t\t\thandle.quaternion.copy( quaternion );\r\n\r\n\t\t\tif ( this.mode === 'translate' || this.mode === 'scale' ) {\r\n\r\n\t\t\t\t// Hide translate and scale axis facing the camera\r\n\r\n\t\t\t\tvar AXIS_HIDE_TRESHOLD = 0.99;\r\n\t\t\t\tvar PLANE_HIDE_TRESHOLD = 0.2;\r\n\t\t\t\tvar AXIS_FLIP_TRESHOLD = 0.0;\r\n\r\n\r\n\t\t\t\tif ( handle.name === 'X' || handle.name === 'XYZX' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Y' || handle.name === 'XYZY' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'XY' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'YZ' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'XZ' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Flip translate and scale axis ocluded behind another axis\r\n\r\n\t\t\t\tif ( handle.name.search( 'X' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tif ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\thandle.scale.x *= - 1;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\r\n\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name.search( 'Y' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tif ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\thandle.scale.y *= - 1;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\r\n\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name.search( 'Z' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tif ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\thandle.scale.z *= - 1;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\r\n\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( this.mode === 'rotate' ) {\r\n\r\n\t\t\t\t// Align handles to current local or world rotation\r\n\r\n\t\t\t\ttempQuaternion2.copy( quaternion );\r\n\t\t\t\talignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).invert() );\r\n\r\n\t\t\t\tif ( handle.name.search( 'E' ) !== - 1 ) {\r\n\r\n\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'X' ) {\r\n\r\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitX, Math.atan2( - alignVector.y, alignVector.z ) );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\r\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Y' ) {\r\n\r\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\r\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Z' ) {\r\n\r\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\r\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Hide disabled axes\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'X' ) === - 1 || this.showX );\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'Y' ) === - 1 || this.showY );\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'Z' ) === - 1 || this.showZ );\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'E' ) === - 1 || ( this.showX && this.showY && this.showZ ) );\r\n\r\n\t\t\t// highlight selected axis\r\n\r\n\t\t\thandle.material._opacity = handle.material._opacity || handle.material.opacity;\r\n\t\t\thandle.material._color = handle.material._color || handle.material.color.clone();\r\n\r\n\t\t\thandle.material.color.copy( handle.material._color );\r\n\t\t\thandle.material.opacity = handle.material._opacity;\r\n\r\n\t\t\tif ( ! this.enabled ) {\r\n\r\n\t\t\t\thandle.material.opacity *= 0.5;\r\n\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\r\n\r\n\t\t\t} else if ( this.axis ) {\r\n\r\n\t\t\t\tif ( handle.name === this.axis ) {\r\n\r\n\t\t\t\t\thandle.material.opacity = 1.0;\r\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\r\n\r\n\t\t\t\t} else if ( this.axis.split( '' ).some( function ( a ) {\r\n\r\n\t\t\t\t\treturn handle.name === a;\r\n\r\n\t\t\t\t} ) ) {\r\n\r\n\t\t\t\t\thandle.material.opacity = 1.0;\r\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thandle.material.opacity *= 0.25;\r\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTransformControlsGizmo.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\tconstructor: TransformControlsGizmo,\r\n\r\n\tisTransformControlsGizmo: true\r\n\r\n} );\r\n\r\n\r\nvar TransformControlsPlane = function () {\r\n\r\n\t'use strict';\r\n\r\n\tMesh.call( this,\r\n\t\tnew PlaneBufferGeometry( 100000, 100000, 2, 2 ),\r\n\t\tnew MeshBasicMaterial( { visible: false, wireframe: true, side: DoubleSide, transparent: true, opacity: 0.1, toneMapped: false } )\r\n\t);\r\n\r\n\tthis.type = 'TransformControlsPlane';\r\n\r\n\tvar unitX = new Vector3( 1, 0, 0 );\r\n\tvar unitY = new Vector3( 0, 1, 0 );\r\n\tvar unitZ = new Vector3( 0, 0, 1 );\r\n\r\n\tvar tempVector = new Vector3();\r\n\tvar dirVector = new Vector3();\r\n\tvar alignVector = new Vector3();\r\n\tvar tempMatrix = new Matrix4();\r\n\tvar identityQuaternion = new Quaternion();\r\n\r\n\tthis.updateMatrixWorld = function () {\r\n\r\n\t\tvar space = this.space;\r\n\r\n\t\tthis.position.copy( this.worldPosition );\r\n\r\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\r\n\r\n\t\tunitX.set( 1, 0, 0 ).applyQuaternion( space === 'local' ? this.worldQuaternion : identityQuaternion );\r\n\t\tunitY.set( 0, 1, 0 ).applyQuaternion( space === 'local' ? this.worldQuaternion : identityQuaternion );\r\n\t\tunitZ.set( 0, 0, 1 ).applyQuaternion( space === 'local' ? this.worldQuaternion : identityQuaternion );\r\n\r\n\t\t// Align the plane for current transform mode, axis and space.\r\n\r\n\t\talignVector.copy( unitY );\r\n\r\n\t\tswitch ( this.mode ) {\r\n\r\n\t\t\tcase 'translate':\r\n\t\t\tcase 'scale':\r\n\t\t\t\tswitch ( this.axis ) {\r\n\r\n\t\t\t\t\tcase 'X':\r\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitX );\r\n\t\t\t\t\t\tdirVector.copy( unitX ).cross( alignVector );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitY );\r\n\t\t\t\t\t\tdirVector.copy( unitY ).cross( alignVector );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'Z':\r\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitZ );\r\n\t\t\t\t\t\tdirVector.copy( unitZ ).cross( alignVector );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'XY':\r\n\t\t\t\t\t\tdirVector.copy( unitZ );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'YZ':\r\n\t\t\t\t\t\tdirVector.copy( unitX );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'XZ':\r\n\t\t\t\t\t\talignVector.copy( unitZ );\r\n\t\t\t\t\t\tdirVector.copy( unitY );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'XYZ':\r\n\t\t\t\t\tcase 'E':\r\n\t\t\t\t\t\tdirVector.set( 0, 0, 0 );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'rotate':\r\n\t\t\tdefault:\r\n\t\t\t\t// special case for rotate\r\n\t\t\t\tdirVector.set( 0, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( dirVector.length() === 0 ) {\r\n\r\n\t\t\t// If in rotate mode, make the plane parallel to camera\r\n\t\t\tthis.quaternion.copy( this.cameraQuaternion );\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( tempMatrix );\r\n\r\n\t\t}\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTransformControlsPlane.prototype = Object.assign( Object.create( Mesh.prototype ), {\r\n\r\n\tconstructor: TransformControlsPlane,\r\n\r\n\tisTransformControlsPlane: true\r\n\r\n} );\r\n\r\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };\r\n","import {  Matrix4} from 'three/build/three.module.js';\r\nvar OrientationControls = function () {\r\n\r\n    function epsilon( value ) {\r\n\r\n        return Math.abs( value ) < 1e-10 ? 0 : value;\r\n\r\n    }\r\n\r\n    function getObjectCSSMatrix( matrix ) {\r\n\r\n        const elements = matrix.elements;\r\n        const matrix3d = 'matrix3d(' +\r\n            epsilon( elements[ 0 ] ) + ',' +\r\n            epsilon( elements[ 1 ] ) + ',' +\r\n            epsilon( elements[ 2 ] ) + ',' +\r\n            epsilon( elements[ 3 ] ) + ',' +\r\n            epsilon( -elements[ 4 ] ) + ',' +\r\n            epsilon( -elements[ 5 ] ) + ',' +\r\n            epsilon( -elements[ 6 ] ) + ',' +\r\n            epsilon( -elements[ 7 ] ) + ',' +\r\n            epsilon( elements[ 8 ] ) + ',' +\r\n            epsilon( elements[ 9 ] ) + ',' +\r\n            epsilon( elements[ 10 ] ) + ',' +\r\n            epsilon( elements[ 11 ] ) + ',' +\r\n            epsilon( elements[ 12 ] ) + ',' +\r\n            epsilon( elements[ 13 ] ) + ',' +\r\n            epsilon( elements[ 14 ] ) + ',' +\r\n            epsilon( elements[ 15 ] ) +\r\n            ')';\r\n\r\n\r\n        return 'translate(-50%,-50%)' + matrix3d;\r\n\r\n    }\r\n\r\n    // const matrix = new THREE.Matrix4;\r\n    const matrix = new Matrix4;\r\n\r\n    const defaultStyle = `\r\n        .orientationControls {\r\n            font-family: sans-serif;\r\n            position: absolute;\r\n            z-index: 1;\r\n            transform: scaleY(-1);\r\n            -webkit-touch-callout: none;\r\n            -webkit-user-select: none;\r\n            -khtml-user-select: none;\r\n            -moz-user-select: none;\r\n            -ms-user-select: none;\r\n            user-select: none;\r\n        }\r\n        \r\n        .orientationControls > .box {\r\n            position: relative;\r\n            transform-style: preserve-3d;\r\n        }\r\n        \r\n        .orientationControls > .box > .face {\r\n            cursor: grab;\r\n            background-color: #dadee9;\r\n            position: absolute;\r\n            box-shadow: inset 0 0 0 2px #747883;\r\n            font-weight: bold;\r\n            color: #747883;\r\n            text-align: center;\r\n        }\r\n        \r\n        .orientationControls > .box > .face:hover {\r\n            background-color: #a8acba;\r\n        }\r\n        \r\n        .orientationControls > .box > .ring {\r\n\t\t\tpointer-events: none;\r\n            position: absolute;\r\n            border-radius: 100%;\r\n            box-shadow: inset 0 0 0 3px #747883, 0 0 0 10px #dadee92e;\r\n        }\r\n        .orientationControls > .box > .ring > div {\r\n            color: #747883;\r\n            position: absolute;\r\n            font-weight: bold;\r\n        }\r\n    `;\r\n\r\n    const sides = {\r\n        front: 'rotateY(  0deg) translateZ(%SIZE)',\r\n        right: 'rotateY( 90deg) translateZ(%SIZE)',\r\n        back: 'rotateY(180deg) translateZ(%SIZE)',\r\n        left: 'rotateY(-90deg) translateZ(%SIZE)',\r\n        top: 'rotateX( 90deg) translateZ(%SIZE)',\r\n        bottom: 'rotateX(-90deg) translateZ(%SIZE)'\r\n    };\r\n\r\n    const offsets = {\r\n        n: [ 0, -1 ],\r\n        e: [ 1, 0 ],\r\n        s: [ 0, 1 ],\r\n        w: [ -1, 0 ]\r\n    };\r\n\r\n    function OrientationControls( size, options ) {\r\n\r\n        size = size || 80;\r\n        options = options || {};\r\n\r\n        const unit = 'px';\r\n        const half = size / 2;\r\n\r\n\r\n        options.perspective = options.perspective || false;\r\n        options.defaultStyle = options.defaultStyle !== undefined ? options.defaultStyle : true;\r\n\r\n        if ( options.defaultStyle && !OrientationControls.cssElement ) {\r\n\r\n            const head = document.head || document.getElementsByTagName( 'head' )[ 0 ];\r\n            const element = document.createElement( 'style' );\r\n\r\n            element.id = 'orientationControls';\r\n            element.href = undefined;\r\n            element.appendChild( document.createTextNode( defaultStyle ) );\r\n\r\n            head.insertBefore( element, head.firstChild );\r\n\r\n            OrientationControls.cssElement = element;\r\n\r\n        }\r\n\r\n\r\n        // Container\r\n\r\n        const container = document.createElement( 'div' );\r\n\r\n        container.className = 'orientationControls';\r\n\r\n        container.style.width = size + unit;\r\n        container.style.height = size + unit;\r\n        container.style.left = size / 2 + unit;\r\n        container.style.top = size / 2 + unit;\r\n\r\n\r\n        // Box\r\n\r\n        const box = document.createElement( 'div' );\r\n\r\n        box.className = 'box';\r\n        box.style.width = size + unit;\r\n        box.style.height = size + unit;\r\n        box.style.fontSize = ( size / 6 ) + unit;\r\n\r\n        container.appendChild( box );\r\n\r\n\r\n        // Ring + cardinal points\r\n\r\n        const ring = document.createElement( 'div' );\r\n\r\n        const R = 1.7320508075688772;\r\n        const s = size * R / 2;\r\n\r\n        const directions = {\r\n            n: 'translateX(' + s + unit + ') translateY(' + 0 + unit + ')',\r\n            e: 'translateX(' + s * 2 + unit + ') translateY(' + s + unit + ')',\r\n            s: 'translateX(' + s + unit + ') translateY(' + s * 2 + unit + ')',\r\n            w: 'translateX(' + 0 + unit + ') translateY(' + s + unit + ')'\r\n        };\r\n\r\n        function direction( name ) {\r\n\r\n            const e = document.createElement( 'div' );\r\n\r\n            const id = name.toLowerCase();\r\n\r\n            const fs = size / 6;\r\n\r\n\r\n            e.id = id;\r\n            e.textContent = name;\r\n            e.style.transform = directions[ id ];\r\n            e.style.fontSize = fs + unit;\r\n            e.style.left = ( -size / 2 / 6 - offsets[ id ][ 0 ] * fs ) + unit;\r\n            e.style.top = ( -size / 2 / 6 - offsets[ id ][ 1 ] * fs ) + unit;\r\n\r\n            ring.appendChild( e );\r\n        }\r\n\r\n        direction( 'N' );\r\n        direction( 'E' );\r\n        direction( 'S' );\r\n        direction( 'W' );\r\n\r\n        ring.className = 'ring';\r\n        ring.style.transform = 'rotateX(90deg) translateZ(' + ( -size / 5 ) + unit + ') translateX(' + ( -size / 3 ) + unit + ')';\r\n        ring.style.width = size * R + unit;\r\n        ring.style.height = size * R + unit;\r\n\r\n        box.appendChild( ring );\r\n\r\n\r\n        // Sides\r\n\r\n        function plane( side ) {\r\n\r\n            const e = document.createElement( 'div' );\r\n\r\n            const id = side.toLowerCase();\r\n\r\n            e.id = id;\r\n            switch(side){\r\n\t\t\t\tcase 'Front':\r\n\t\t\t\t\te.textContent = \"前\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Right':\r\n\t\t\t\t\te.textContent = \"右\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Back':\r\n\t\t\t\t\te.textContent = \"后\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Left':\r\n\t\t\t\t\te.textContent = \"左\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Top':\r\n\t\t\t\t\te.textContent = \"上\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Bottom':\r\n\t\t\t\t\te.textContent = \"下\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n            // e.textContent = side;\r\n            e.className = id + ' face';\r\n\r\n            e.style.width = size + unit;\r\n            e.style.height = size + unit;\r\n            e.style.transform = sides[ id ].replace( '%SIZE', ( size / 2 ) + unit );\r\n            e.style.lineHeight = size + unit;\r\n\r\n            box.appendChild( e );\r\n\r\n            return e;\r\n\r\n        }\r\n\r\n        plane( 'Front' );\r\n        plane( 'Right' );\r\n        plane( 'Back' );\r\n        plane( 'Left' );\r\n        plane( 'Top' );\r\n        plane( 'Bottom' );\r\n\r\n\t\t/*plane( '前' );\r\n        plane( '右' );\r\n        plane( '后' );\r\n        plane( '左' );\r\n        plane( '上' );\r\n        plane( '下' );\r\n*/\r\n\r\n\r\n        this.element = container;\r\n\r\n        this.update = function () {\r\n\r\n            matrix.copy( window.camera.matrixWorldInverse );\r\n\r\n            matrix.elements[ 12 ] = half;\r\n            matrix.elements[ 13 ] = half;\r\n            matrix.elements[ 14 ] = 0;\r\n\r\n            const style = getObjectCSSMatrix( matrix );\r\n\r\n            box.style.WebkitTransform = style;\r\n            box.style.transform = style;\r\n\r\n\t\t\tcontainer.style.perspective = ( ( options.perspective && window.camera.isPerspectiveCamera ) ?\r\n\t\t\t( Math.pow( size * size + size * size, 0.5 ) / Math.tan( ( window.camera.fov / 2 ) * Math.PI / 180 ) ) : 0 ) + unit;\r\n\r\n\r\n\r\n        };\r\n\r\n    }\r\n\r\n    return OrientationControls;\r\n\r\n}();\r\n\r\nexport {OrientationControls}\r\n","// extracted by mini-css-extract-plugin","import mod from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeDimensionalBuilder.vue?vue&type=style&index=0&id=7c8a8f6c&scoped=true&lang=stylus&\"; export default mod; export * from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ThreeDimensionalBuilder.vue?vue&type=style&index=0&id=7c8a8f6c&scoped=true&lang=stylus&\"","// extracted by mini-css-extract-plugin","<template>\r\n  <div class='builder fixedBuilder'>\r\n    <div :class='`main_wrapper main_wrapper_${this.$i18n.locale}`' id='mainWrapper'>\r\n      <div id='container' class='clearfix' @click='containerListenner' @mousedown='containerMouseDown'\r\n           @mousemove='containerMouseMove' @mouseup='containerMouseUp'></div>\r\n      <div class='show_more clearfix' @click='showMoreFn()' :class=\"showMore?'':'show_more_close'\"><img\r\n        src='/image/3dBuilder/arrow.png' alt=''></div>\r\n      <div v-show='showMore' id='shapes' class='clearfix'>\r\n        <div class='shapes_wrapper' v-if='!shapesListShow && !cartoonStlShow'>\r\n          <div class='shapes_options normal' @click='showModule(0)'>{{ $t('REGULAR') }} {{ $t('MODEL') }} <i\r\n            class='iconfont arrow arrow_right'>&#xe6f8;</i></div>\r\n          <div class='shapes_options cartoon' @click='showModule(1)'>{{ $t('CARTOON') }} {{ $t('MODEL') }} <i\r\n            class='iconfont arrow arrow_right'>&#xe6f8;</i></div>\r\n        </div>\r\n        <div id='childWrapper' v-if='shapesListShow || cartoonStlShow'>\r\n          <div class='child_wrapper normal_wrapper' v-if='shapesListShow'>\r\n            <div class='child_title' @click='hideModule()'><i class='iconfont arrow'>&#xe720;</i>{{ $t('REGULAR') }}\r\n              {{ $t('MODEL') }}\r\n            </div>\r\n            <div v-for='(item, index) in shapesList'\r\n                 :key=index\r\n                 :class='item.title'\r\n                 @click='selectModule(0,item.code,index,item.module)'\r\n                 class='module shapes drag'>\r\n              <input v-if=\"item.module =='shape'\" class='this_module' type='hidden' value='0'>\r\n              <input v-else-if=\"item.module =='stl'\" class='this_module' type='hidden' value='1'>\r\n              <input v-else-if=\"item.module =='text'\" class='this_module' type='hidden' value='2'>\r\n              <input class='this_code' type='hidden' :value='item.code'>\r\n              <div class='drag sprint' :class=\"'sprint_'+item.title\"\r\n                   v-lazy:background-image=\"'/image/3dBuilder/3dPrinting/sprint_'+item.title+'.png'\"></div>\r\n              <div class='name drag'>{{ $t(item.name) }}</div>\r\n            </div>\r\n          </div>\r\n          <div class='child_wrapper cartoon_wrapper' v-if='cartoonStlShow'>\r\n            <div class='child_title' @click='hideModule()'><i class='iconfont arrow'>&#xe720;</i>{{ $t('CARTOON') }}\r\n              {{ $t('MODEL') }}\r\n            </div>\r\n            <div v-for='(item, index) in cartoonStlList'\r\n                 :key=index\r\n                 :class='item.title'\r\n                 @click='selectModule(1,item.code,index,item.module)'\r\n                 class='module lego drag'>\r\n              <input class='this_module' type='hidden' value='1'>\r\n              <input class='this_code' type='hidden' :value='index'>\r\n              <div class='drag sprint sprintY' :class=\"'sprint_'+item.title\"\r\n                   v-lazy:background-image=\"'/image/3dBuilder/3dPrinting/sprint_'+item.title+'.png'\"></div>\r\n              <div class='name drag'>{{ $t(item.name) }}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class='module_btns clearfix'>\r\n        <div class='btn_main go_mainPage' @click='leaveBuilder()'>\r\n          <div class='btn_child btn_home'><i class='iconfont'>&#xe651;</i></div>\r\n          <div class='module_btn_name'>{{ $t('BACK') }}</div>\r\n        </div>\r\n        <div class='btn_main save_module save_stl' :class=\"activeSave?'':'noActive_save'\" @click='saveModuleShow(0)'>\r\n          <div class='btn_child btn_save_module'><i class='iconfont'>&#xe710;</i></div>\r\n          <div class='module_btn_name'>{{ $t('SAVE') }}</div>\r\n        </div>\r\n      </div>\r\n      <div class='obj_control has_right_menu'>\r\n        <div class='obj_control_wrapper clearfix' v-if='controlBar'>\r\n          <div class='control_btn undo_control ' :class=\"undoActive?'':'noActive_control'\" @click='redoUndo(0)'>\r\n            <i class='iconfont'>&#xe696;</i>\r\n            <div class='btn_name'>{{ $t('REDO') }}</div>\r\n          </div>\r\n          <div class='control_btn redo_control ' :class=\"redoActive?'':'noActive_control'\" @click='redoUndo(1)'>\r\n            <i class='iconfont'>&#xe697;</i>\r\n            <div class='btn_name'>{{ $t('UNDO') }}</div>\r\n          </div>\r\n          <div class='control_btn size_control' @click='changeControls(0)'>\r\n            <div class='icon_wrapper'>\r\n              <i class='iconfont'>&#xe6aa;</i>\r\n            </div>\r\n            <div class='btn_name'>{{ $t('CHANGE_SIZE') }}</div>\r\n          </div>\r\n          <div class='control_btn trans_control active_control' @click='changeControls(1)'>\r\n            <div class='icon_wrapper'>\r\n              <i class='iconfont'>&#xe69b;</i>\r\n            </div>\r\n            <div class='btn_name'>{{ $t('MOVE') }}</div>\r\n          </div>\r\n          <div class='control_btn rotate_control' @click='changeControls(2)'>\r\n            <div class='icon_wrapper'>\r\n              <i class='iconfont'>&#xe626;</i>\r\n            </div>\r\n            <div class='btn_name'>{{ $t('ROTATE') }}</div>\r\n          </div>\r\n          <div class='control_btn zoomin_control' @click='showChild(0)'>\r\n            <i class='iconfont'>&#xe64e;</i>\r\n            <div class='btn_name'>{{ $t('ZOOM') }}</div>\r\n            <div class='zoom_options' v-if='showZoomOption'>\r\n              <div class='zoom_opt' @click='zoomView(50)'>50%</div>\r\n              <div class='zoom_opt' @click='zoomView(100)'>100%</div>\r\n              <div class='zoom_opt' @click='zoomView(200)'>200%</div>\r\n            </div>\r\n          </div>\r\n          <!--<div class=\"control_btn zoomout_control\" @click=\"cameraSides(7)\">\r\n                  <i class=\"iconfont\">&#xe691;</i>\r\n                  <div class=\"btn_name\">放大</div>\r\n              </div>\r\n              <div class=\"control_btn zoomout_control\" @click=\"cameraSides(8)\">\r\n                  <i class=\"iconfont\">&#xe632;</i>\r\n                  <div class=\"btn_name\">缩小</div>\r\n              </div>-->\r\n          <div class='control_btn delete_control' @click='deletedSelected()'>\r\n            <i class='iconfont'>&#xe783;</i>\r\n            <div class='btn_name'>{{ $t('DELETE') }}</div>\r\n          </div>\r\n          <div class='control_btn color_control_wrapper' v-if='colorControl' @click='showChild(1)'>\r\n            <div class='color_circle outside_color' :class=\"isWhite?'white_color_circle':''\"></div>\r\n            <div class='btn_name'>{{ $t('COLOR') }}</div>\r\n            <div class='color_wrapper' v-if='showColorOption'>\r\n              <div class='color_control yellow_control' @click='changeCurrentColor(1)'>\r\n                <div class='color_circle'></div>\r\n              </div>\r\n              <div class='color_control white_control' @click='changeCurrentColor(0)'>\r\n                <div class='color_circle'></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n        <!--<div class=\"zoom_control\">\r\n              <div class=\"iconfont\" @click=\"cameraSides(7)\">&#xe611;</div>\r\n              <div class=\"zoom_index\">100%</div>\r\n              <div class=\"iconfont\" @click=\"cameraSides(8)\">&#xe626;</div>\r\n          </div>-->\r\n      </div>\r\n    </div>\r\n    <div class='save_name_module_bg' v-if='saveNmaeWindow'></div>\r\n    <div class='save_name_module' v-if='saveNmaeWindow'>\r\n      <div class='save_name_title'>{{ $t('NAME') }}</div>\r\n      <div class='save_name_tip'>{{ $t('NAME_MODEL') }}</div>\r\n      <input type='text' placeholder=\"$t('ENTER_MODEL_NAME')\" maxlength='14' id='save_name'\r\n             oninput=\"saveModuleName(this,'oninput')\"\r\n             onblur=\"saveModuleName(this,'onblur')\" onFocus=\"saveModuleName(this,'onFocus')\"\r\n             onkeyup=\"this.value=this.value.replace(/[^\\a-\\z\\A-\\Z0-9\\u4E00-\\u9FA5]/g ,'')\"\r\n             blur=\"saveModuleName(this,'blur')\"\r\n             :value=this.getTimeStr()\r\n      >\r\n      <div class='save_name_verify'>{{ $t('ENTER_MODEL_NAME') }}</div>\r\n      <div class='btn_wrapper clearfix'>\r\n        <img src='/image/3dBuilder/3dPrinting/btn_yes1.png' class='save_name_ok' @click=\"activeSave?exportMoudle(0):''\">\r\n        <img src='/image/3dBuilder/3dPrinting/btn_close.png' class='imgBtn save_name_cancle'\r\n             @click='saveModuleShow(1)'>\r\n      </div>\r\n    </div>\r\n    <div class='save_ask_module_bg' v-if='notSaveNote'></div>\r\n    <div class='save_ask' v-if='notSaveNote'>\r\n      <div class='save_name_title'>{{ $t('NOTE') }}</div>\r\n      <div class='save_name_tip'>\r\n        {{ $t('SAVE_OR_NOT') }}\r\n      </div>\r\n      <div class='btn_wrapper clearfix'>\r\n        <img src='/image/3dBuilder/3dPrinting/btn_no.png' class='go_home_ok' @click='goHomeSaveModule(0)'>\r\n        <img src='/image/3dBuilder/3dPrinting/btn_yes.png' class='go_home_ok' @click='goHomeSaveModule(1)'>\r\n        <img src='/image/3dBuilder/3dPrinting/btn_close.png' class='imgBtn save_name_cancle' @click='hideAskWindow()'>\r\n      </div>\r\n    </div>\r\n    <div class='note'>\r\n      <div class='select_module'>选择一个模型，点击 箭头按 <span class='red'>X</span>,<span class='green'>Y</span>,<span\r\n        class='blue'>Z</span>单向缩放,点击中心方块或 者双指，进行整体 缩放\r\n      </div>\r\n    </div>\r\n    <div class='text_window' v-if='showTextWindow'>\r\n      <div class='text_title'>{{$t('GENERATE_TEXT')}}</div>\r\n      <input type='text' placeholder=\"$t{'ENTER_TEXT'}\" maxlength='10' id='textContent' @input='textInputFn'\r\n             @blur='textInputFn'>\r\n      <div class='btn_wrapper clearfix'>\r\n        <div class='btns btn_ok text_ok' :class=\"inputCanConfirm?'':'btn_disable'\"\r\n             @click='inputCanConfirm?insertWord():null'>{{$t('CONFIRM')}}\r\n        </div>\r\n        <div class='btns btn_cancle text_cancle' @click='showInput(1)'>{{$t('CANCEL')}}</div>\r\n      </div>\r\n    </div>\r\n    <div class='control_type' v-if='controlType' v-text='statusTxt'>{{$t('CURRENT_STATUS')}} {{$t('MOVE')}}</div>\r\n    <div id='loading_data' :class=\"showMore?'hideShowMore':''\" v-if='showLoading'><img\r\n      src='/image/3dBuilder/loading.gif' alt=''>\r\n      <div class='processingbar'>\r\n        <div class='barwidth' :style=\"{width:progressingBar+'%'}\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport '@/assets/threejs/common.css'\r\nimport * as THREE from 'three/build/three.module.js'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\nimport { STLLoader } from 'three/examples/jsm/loaders/STLLoader'\r\nimport { STLExporter } from 'three/examples/jsm/exporters/STLExporter'\r\n// import {TransformControls} from 'three/examples/jsm/controls/TransformControls'\r\nimport { TransformControls } from '@/assets/threejs/TransformControls.js'\r\n// import {EffectComposer} from 'three/examples/jsm/postprocessing/EffectComposer'\r\n// import { OrientationControls } from './js/OrientationControls2.js'\r\nimport { OrientationControls } from '@/assets/threejs/OrientationControls2.js'\r\n\r\nexport default {\r\n  name: 'ThreeDimensionalBuilder',\r\n  data() {\r\n    return {\r\n      mobile: false,\r\n      WORK_SPACE_SIZE: 200,\r\n      CONTAIN_WIDTH: null,\r\n      CONTAIN_HEIGHT: null,\r\n      SHAPE_SIZE: 20,\r\n      LIMIT_SIZE: 4,\r\n      renderer: null,\r\n      camera: null,\r\n      cameraZoom: 1,\r\n      scene: null,\r\n      plane: null,\r\n      objects: [],\r\n      shapesObj: [], //所有的当前已放置的obj\r\n      gridHelper: null,\r\n      gradGroundMesh: null,\r\n      mouseHelper: null,\r\n      mouseHelperMaterial: null,\r\n      focusedTransformObj: null,\r\n      deleteObjFlag: null,\r\n      gradGroundMesh1: null,\r\n      composer: null,\r\n      renderPass: null,\r\n      outlinePass: null,\r\n      effectFXAA: null,\r\n      controls: null,\r\n      transformControl: null,\r\n      container: null,\r\n      orientationContr: null,\r\n      controlsMoved: false,\r\n      shapesEventL: null,\r\n      shapesMain: null,\r\n      showMore: true,\r\n      showZoomOption: false,\r\n      showColorOption: false,\r\n      isWhite: true,\r\n      colorControl: true,\r\n      selectedDragObj: null,\r\n      selectedDragObjFlag: null,\r\n      dragObj: null,\r\n      dragedFlag: null,\r\n      maxW: null,\r\n      maxH: null,\r\n      movedDir: null,\r\n      shapesList: [],\r\n      cartoonStlList: [],\r\n      shapesListShow: true,\r\n      cartoonStlShow: false,\r\n      controlBar: false,\r\n      redoActive: false,\r\n      undoActive: false,\r\n      stlGeoFlag: null, //0: get 1 stl\r\n      showTextWindow: false,\r\n      currentObj: null,\r\n      textInput: '',\r\n      textInput1: '',\r\n      fontLoader: null,\r\n      wordFont: null,\r\n      wordColor: 0xdddddd,\r\n      shootedFlag: false,\r\n      currentObjMesh: null,\r\n      currentObjMaterial: null,\r\n      currentModule: 0,//编辑模式，各种基础模型\r\n      // container监听事件\r\n      transformDragFlag: false,\r\n      twoPointTouchFlag: false,\r\n      mouse: null,\r\n      raycaster: null,\r\n      isShiftDown: false,\r\n      saveFlag: false,//是否保存\r\n      activeSave: false,//是否激活保存样式\r\n      saveNmaeWindow: false,//是否显示保存窗口\r\n      notSaveNote: false,//是否显示未保存提示窗口\r\n      goHomeFlag: false,//是否是点击返回按钮\r\n      allOperation: [],//all the operated operation(undo)\r\n      eachObjectInfo: {},//每一个对象的每一个步骤；\r\n      eachRedoObjectInfo: {},//每一个对象的每一个步骤；\r\n      redoOperation: [],//all the redo operation : false,\r\n      selectedObjects: [],//当前加outline的对象\r\n      statusTxt: null,\r\n      controlType: null,//是否显示文案\r\n      transformControlModeType: 1, //当前transformControl的 模式  0:scale  1:translate  2:rotate\r\n      intersectsSelect: [], //焦点 交点\r\n      intersection: {\r\n        intersects: false,\r\n        point: new THREE.Vector3(),\r\n        normal: new THREE.Vector3()\r\n      },\r\n      tcScale: null,\r\n      tcScaleYPosition: null,\r\n      tcScaleY: null,\r\n      tcScaleYPositionFlag: null,\r\n      tcX: null,\r\n      tcY: null,\r\n      tcZ: null,\r\n      showLoading: false,\r\n      progressingBar: 0,\r\n      inputCanConfirm: false\r\n\r\n    }\r\n  },\r\n  methods: {\r\n    init() {\r\n      const _this = this\r\n      _this.container = document.getElementById('container')\r\n      _this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true })\r\n      _this.renderer.setPixelRatio((window.devicePixelRatio) ? window.devicePixelRatio : 1)\r\n      // _this.renderer.setSize( this.CONTAIN_WIDTH, this.CONTAIN_HEIGHT );\r\n      _this.renderer.setSize(_this.CONTAIN_WIDTH, _this.CONTAIN_HEIGHT)\r\n      _this.renderer.shadowMap.enabled = true\r\n      _this.renderer.autoClear = false\r\n      _this.renderer.setClearColor(0x000000, 0.0)\r\n      _this.container.appendChild(_this.renderer.domElement)\r\n      _this.camera = new THREE.PerspectiveCamera(45, _this.CONTAIN_WIDTH / _this.CONTAIN_HEIGHT, 1, 10000)\r\n      // camera.position.set( 0, 200, 350 ); //正面\r\n      _this.camera.position.set(170, 145, 255) //45°\r\n      _this.camera.lookAt(0, 0, 0)\r\n      window.camera = _this.camera\r\n      _this.scene = new THREE.Scene()\r\n      const geometry = new THREE.PlaneBufferGeometry(_this.WORK_SPACE_SIZE, _this.WORK_SPACE_SIZE)\r\n      geometry.rotateX(-Math.PI / 2)\r\n      _this.plane = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({ color: 0xe5e4df, visible: true }))\r\n      _this.plane.name = 'plane'\r\n      _this.plane.receiveShadow = true\r\n      _this.plane.castShadow = true\r\n      _this.scene.add(_this.plane)\r\n      _this.objects.push(_this.plane)\r\n\r\n      _this.raycaster = new THREE.Raycaster()\r\n      _this.mouse = new THREE.Vector2()\r\n\r\n      _this.grads()\r\n\r\n      // lights\r\n      var ambientLight = new THREE.AmbientLight(0x606060, 1) //0x606060\r\n      _this.scene.add(ambientLight)\r\n      var directionalLight = new THREE.DirectionalLight(0xFFFFFF, 1.3)\r\n      directionalLight.position.set(1, 0.75, 0.5).normalize()\r\n      _this.scene.add(directionalLight)\r\n      // lights end\r\n      // _this.outline(); //objects outline\r\n      _this.orbitCont()\r\n      _this.transformCont()\r\n      // _this.orientationCont()\r\n      // _this.containerListenner();\r\n      _this.animate()\r\n      _this.onWindowResize()\r\n    },\r\n    grads() {\r\n      // grid\r\n      this.gridHelper = new THREE.GridHelper(this.WORK_SPACE_SIZE, 20, 0x999999, 0xc999999)\r\n      // gridHelper = new THREE.GridHelper( 300, 6, 0x999999, 0xc999999 );\r\n      this.gridHelper.name = 'GridHelper'\r\n      this.scene.add(this.gridHelper)\r\n      this.gradGroundMesh = new THREE.Mesh(new THREE.BoxBufferGeometry(this.WORK_SPACE_SIZE, .8, this.WORK_SPACE_SIZE), new THREE.MeshLambertMaterial({ color: 0xffffff }))\r\n      this.gradGroundMesh.position.y = -.8\r\n      this.gradGroundMesh.name = 'GridHelper'\r\n      this.gradGroundMesh.receiveShadow = true\r\n      this.gradGroundMesh.castShadow = true\r\n      this.scene.add(this.gradGroundMesh)\r\n      this.gradGroundMesh1 = new THREE.Mesh(new THREE.BoxBufferGeometry(this.WORK_SPACE_SIZE, 3, this.WORK_SPACE_SIZE), new THREE.MeshLambertMaterial({ color: 0xffc869 }))\r\n      this.gradGroundMesh1.position.y = -2.5\r\n      this.gradGroundMesh1.name = 'GridHelper'\r\n      this.gradGroundMesh1.receiveShadow = true\r\n      this.gradGroundMesh1.castShadow = true\r\n      this.scene.add(this.gradGroundMesh1)\r\n      //grid end\r\n    },\r\n    outline() {\r\n      // outline\r\n      this.composer = new THREE.EffectComposer(this.renderer)\r\n      var renderPass = new THREE.RenderPass(this.scene, this.camera)\r\n      this.composer.addPass(renderPass)\r\n      this.outlinePass = new THREE.OutlinePass(new THREE.Vector2(this.CONTAIN_WIDTH - 100, this.CONTAIN_HEIGHT), this.scene, this.camera)\r\n      this.outlinePass.edgeStrength = 4//强度 默认3\r\n      this.outlinePass.edgeThickness = 1\r\n      this.outlinePass.visibleEdgeColor.set('#00ff00')// 边缘可见部分发光颜色\r\n      this.outlinePass.hiddenEdgeColor.set('#00ff00')//边缘遮挡部分发光颜色\r\n      this.outlinePass.edgeGlow = 1//发光颜色虚边\r\n      // outlinePass.pulsePeriod= 3;//发光颜色闪烁频率\r\n\r\n      this.composer.addPass(this.outlinePass)\r\n      this.effectFXAA = new THREE.ShaderPass(THREE.FXAAShader)\r\n      this.effectFXAA.uniforms['resolution'].value.set(1 / this.CONTAIN_WIDTH, 1 / this.CONTAIN_HEIGHT)\r\n      // outline end\r\n    },\r\n    orbitCont() {\r\n      var _this = this\r\n      // 旋转控制\r\n      _this.controls = new OrbitControls(_this.camera, _this.renderer.domElement) // project controller\r\n      _this.controls.minDistance = 10 //设置相机距离原点的最近距离 min distance of camera to coordinate origin\r\n      _this.controls.maxDistance = 1300//设置相机距离原点的最远距离 max distance of camera to coordinate origin\r\n      _this.controls.enableKeys = true\r\n      _this.controls.rotateSpeed = .3\r\n      _this.controls.keys = {\r\n        LEFT: 65, //left arrow\r\n        UP: 87, // up arrow\r\n        RIGHT: 68, // right arrow\r\n        BOTTOM: 83 // down arrow\r\n      }\r\n      _this.controls.enablePan = false//是否开启右键拖拽\r\n      _this.controls.enableZoom = true//是否可以缩放\r\n      // _this.controls.enabled = false;\r\n      _this.controls.addEventListener('change', function() {\r\n        _this.controlsMoved = true\r\n        if (_this.objects.length > 1) {\r\n          if (_this.camera.position.y < 0) { //当镜头在底板 底部后，隐藏\r\n            _this.clearCache(_this.gridHelper)\r\n            _this.scene.remove(_this.gridHelper)\r\n            _this.clearCache(_this.gradGroundMesh)\r\n            _this.scene.remove(_this.gradGroundMesh)\r\n            _this.clearCache(_this.gradGroundMesh1)\r\n            _this.scene.remove(_this.gradGroundMesh1)\r\n          } else {\r\n            _this.clearCache(_this.gridHelper)\r\n            _this.scene.remove(_this.gridHelper)\r\n            _this.clearCache(_this.gradGroundMesh)\r\n            _this.scene.remove(_this.gradGroundMesh)\r\n            _this.clearCache(_this.gradGroundMesh1)\r\n            _this.scene.remove(_this.gradGroundMesh1)\r\n            _this.scene.add(_this.gridHelper)\r\n            _this.scene.add(_this.gradGroundMesh)\r\n            _this.scene.add(_this.gradGroundMesh1)\r\n          }\r\n        } else {\r\n          _this.clearCache(_this.gridHelper)\r\n          _this.scene.remove(_this.gridHelper)\r\n          _this.clearCache(_this.gradGroundMesh)\r\n          _this.scene.remove(_this.gradGroundMesh)\r\n          _this.clearCache(_this.gradGroundMesh1)\r\n          _this.scene.remove(_this.gradGroundMesh1)\r\n          _this.scene.add(_this.gridHelper)\r\n          _this.scene.add(_this.gradGroundMesh)\r\n          _this.scene.add(_this.gradGroundMesh1)\r\n        }\r\n      })\r\n    },\r\n    transformCont() {\r\n      const _this = this\r\n      //移动shape\r\n      _this.transformControl = new TransformControls(this.camera, this.renderer.domElement)\r\n      _this.transformControl.name = 'transformControl'\r\n      _this.transformControl.size = 1.5\r\n      _this.scene.add(_this.transformControl)\r\n      _this.transformControl.addEventListener('dragging-changed', function(event) {\r\n        if (_this.controls) {\r\n          _this.controls.enabled = !event.value\r\n          _this.transformDragFlag = !event.value\r\n        }\r\n      }, false)\r\n      _this.transformControl.addEventListener('change', function() {\r\n        if (_this.shootedFlag) {\r\n          _this.shapesController(0)\r\n        }\r\n        _this.showCurrentColor()\r\n        _this.onAnimationStep()\r\n      }, false)\r\n      _this.transformControl.addEventListener('mouseDown', function() {\r\n        _this.transformControlMove = false\r\n        _this.checkScalePosition(_this.transformControl.object)\r\n      }, false)\r\n      _this.transformControl.addEventListener('objectChange', function() {\r\n        _this.transformControlMove = true\r\n      }, false)\r\n      _this.transformControl.addEventListener('mouseUp', function() {\r\n        if (_this.transformControlMove) {\r\n          _this.allOperationAdd()\r\n        }\r\n        _this.showCurrentColor()\r\n        if (window.focusedTransformObj) {\r\n          _this.transformControl.object = window.focusedTransformObj\r\n        }\r\n      }, false)\r\n      //移动shape End\r\n    },\r\n    containerListenner() {\r\n      this.showColorOption = false\r\n      this.showZoomOption = false\r\n      this.onDocumentMouseDown(event)\r\n    },\r\n    containerMouseDown() {\r\n      var _this = this\r\n      _this.controlsMoved = false\r\n      _this.showColorOption = false\r\n      _this.showZoomOption = false\r\n      _this.controls.enabled = _this.transformDragFlag\r\n      _this.twoPointTouchFlag = false\r\n      _this.touchScale = ''\r\n    },\r\n    containerMouseMove() {\r\n      // this.onDocumentMouseMove(event);\r\n    },\r\n    containerMouseUp() {\r\n      if (this.transformControl.object) {\r\n        window.focusedTransformObj = this.transformControl.object\r\n      }\r\n      if (!this.controlsMoved && !this.transformControlMove) {\r\n        setTimeout(function() {\r\n          this.onDocumentMouseDown(event)\r\n        }, 100)\r\n      }\r\n      this.tcScaleYPosition = ''\r\n      this.tcScaleYPositionFlag = ''\r\n      this.tcScaleY = ''\r\n      this.tcX = ''\r\n      this.tcY = ''\r\n      this.tcZ = ''\r\n      this.transformControlMove = false\r\n    },\r\n    orientationCont() {\r\n      const _this = this\r\n      _this.orientationContr = new OrientationControls(50) //右上角三视图\r\n      document.body.appendChild(_this.orientationContr.element)\r\n      _this.orientationContr.element.addEventListener('click', function(e) {\r\n        switch (e.target.id) {\r\n          case 'front':\r\n            _this.camera.position.set(0, 0, 300)\r\n            break\r\n          case 'back':\r\n            _this.camera.position.set(0, 0, -300)\r\n            break\r\n          case 'top':\r\n            _this.camera.position.set(0, 300, 0)\r\n            break\r\n          case 'bottom':\r\n            _this.camera.position.set(0, -300, 0)\r\n            break\r\n          case 'left':\r\n            _this.camera.position.set(-300, 0, 0)\r\n            break\r\n          case 'right':\r\n            _this.camera.position.set(300, 0, 0)\r\n            break\r\n        }\r\n        _this.camera.lookAt(_this.scene.position)\r\n        _this.camera.updateProjectionMatrix()\r\n      })\r\n\r\n    },\r\n    animate() {\r\n      requestAnimationFrame(this.animate)\r\n      this.renderer.render(this.scene, this.camera)\r\n      // this.orientationContr.update(this.camera)\r\n      // this.composer.render();\r\n    },\r\n    onWindowResize() {\r\n      if (!this.showMore) {\r\n        this.camera.aspect = (this.CONTAIN_WIDTH) / this.CONTAIN_HEIGHT\r\n        this.renderer.setSize(this.CONTAIN_WIDTH, this.CONTAIN_HEIGHT)\r\n        // this.composer.setSize( this.CONTAIN_WIDTH, this.CONTAIN_HEIGHT );\r\n        // this.effectFXAA.uniforms['resolution'].value.set( 1 / this.CONTAIN_WIDTH, 1 / this.CONTAIN_HEIGHT );\r\n\r\n      } else {\r\n        this.camera.aspect = (this.CONTAIN_WIDTH - 100) / this.CONTAIN_HEIGHT\r\n        this.renderer.setSize(this.CONTAIN_WIDTH - 100, this.CONTAIN_HEIGHT)\r\n        // this.composer.setSize( this.CONTAIN_WIDTH - 100, this.CONTAIN_HEIGHT );\r\n        // this.effectFXAA.uniforms['resolution'].value.set( 1 / ( this.CONTAIN_WIDTH - 100 ), 1 / this.CONTAIN_HEIGHT );\r\n      }\r\n      this.camera.updateProjectionMatrix()\r\n    },\r\n    clearCache(currentMesh) {\r\n      currentMesh.geometry.dispose()\r\n      currentMesh.material.dispose()\r\n    },\r\n    render() {\r\n      this.renderer.render(this.scene, this.camera)\r\n    },\r\n    listModule() {\r\n      var url = '/mock/moduleList.json'\r\n      this.$ajax.get(url)\r\n        .then(this.listModuleSucc)\r\n        .catch(function(res) {\r\n          console.error( res)\r\n        })\r\n    },\r\n    listModuleSucc(res) {\r\n      if (res && res.data) {\r\n        this.shapesList = res.data.data.shapes\r\n        this.cartoonStlList = res.data.data.stl\r\n        // this.dropOffListerner();\r\n      }\r\n    },\r\n    showModule(type) {\r\n      if (type == 0) {\r\n        this.shapesListShow = true\r\n        this.cartoonStlShow = false\r\n      } else if (type == 1) {\r\n        this.shapesListShow = false\r\n        this.cartoonStlShow = true\r\n      }\r\n    },\r\n    hideModule() {\r\n      this.shapesListShow = false\r\n      this.cartoonStlShow = false\r\n    },\r\n    showMoreFn() {\r\n      if (this.showMore) {\r\n        this.showMore = false\r\n        $('.orientationControls').addClass('right_menu_hide')\r\n      } else {\r\n        this.showMore = true\r\n        $('.orientationControls').removeClass('right_menu_hide')\r\n      }\r\n      this.onWindowResize()\r\n    },\r\n    dropOffListerner() {\r\n      const _this = this\r\n      _this.shapesMain.addEventListener('touchstart', function() {\r\n        //隐藏子窗口\r\n        _this.showColorOption = false\r\n        _this.showColorOption = false\r\n      })\r\n      _this.shapesEventL.addEventListener('touchstart', function(e) {\r\n        //隐藏子窗口\r\n        _this.showColorOption = false\r\n        _this.showColorOption = false\r\n        _this.selectedDragObj = $(e.target)\r\n        if (_this.selectedDragObj.hasClass('drag')) {\r\n          $('.active_shape').removeClass('active_shape')\r\n          if (_this.selectedDragObj.hasClass('name')) {\r\n            _this.dragObj = $(_this.selectedDragObj).parents('.module').find('.sprint').clone()\r\n            $(_this.selectedDragObj).parents('.module').addClass('active_shape')\r\n            _this.selectedDragObjFlag = true\r\n          } else if (_this.selectedDragObj.hasClass('sprint')) {\r\n            _this.dragObj = _this.selectedDragObj.clone()\r\n            $(_this.selectedDragObj).parents('.module').addClass('active_shape')\r\n            _this.selectedDragObjFlag = true\r\n          } else if (_this.selectedDragObj.hasClass('module')) {\r\n            _this.dragObj = $(_this.selectedDragObj).find('.sprint').clone()\r\n            $(_this.selectedDragObj).addClass('active_shape')\r\n            _this.selectedDragObjFlag = false\r\n          }\r\n          _this.dragObj.addClass('startDrag')\r\n          // _this.maxW = document.body.clientWidth - _this.selectedDragObj[0].offsetWidth;\r\n          // _this.maxH = document.body.clientHeight - _this.selectedDragObj[0].offsetHeight;\r\n          _this.maxW = $('.builder .main_wrapper').width() - _this.selectedDragObj[0].offsetWidth\r\n          _this.maxH = $('.builder .main_wrapper').height() - _this.selectedDragObj[0].offsetHeight\r\n        }\r\n      }, false)\r\n      _this.shapesEventL.addEventListener('touchmove', function(e) {\r\n        _this.dragedFlag = true\r\n        var ev = e || window.event\r\n        var touch = ev.targetTouches[0]\r\n        var windowWidth = window.innerWidth\r\n        _this.movedDir = windowWidth - touch.clientX\r\n        if (_this.dragObj && _this.movedDir > 100) {\r\n          $('body').append(_this.dragObj)\r\n          var oLeft = touch.clientX - 50\r\n          var oTop = touch.clientY - 50\r\n          if (oLeft < 0) {\r\n            oLeft = 0\r\n          } else if (oLeft >= _this.maxW) {\r\n            oLeft = _this.maxW\r\n          }\r\n          if (oTop < 0) {\r\n            oTop\r\n          } else if (oTop >= _this.maxH) {\r\n            oTop = _this.maxH\r\n          }\r\n          _this.dragObj[0].style.left = oLeft + 25 + 'px'\r\n          _this.dragObj[0].style.top = oTop + 'px'\r\n        }\r\n      }, false)\r\n      _this.shapesEventL.addEventListener('touchend', function(e) {\r\n        if (_this.dragObj && _this.dragedFlag && _this.movedDir > 100) {\r\n          // $( selectedDragObj ).parents( \".module\" ).trigger( \"click\" );\r\n          let code, type, url\r\n          if (_this.selectedDragObjFlag) {\r\n            code = Number($(_this.selectedDragObj).parents('.module').find('.this_code').val())\r\n            type = Number($(_this.selectedDragObj).parents('.module').find('.this_module').val())\r\n            url = Number($(_this.selectedDragObj).parents('.module').find('.this_url').val())\r\n          } else if (_this.selectedDragObjFlag == false) {\r\n            code = Number($(_this.selectedDragObj).find('.this_code').val())\r\n            type = Number($(_this.selectedDragObj).find('.this_module').val())\r\n            url = Number($(_this.selectedDragObj).find('.this_url').val())\r\n          }\r\n          if (type == 0) {\r\n            _this.changeShapes(code)\r\n          } else if (type == 1) {\r\n            _this.loadSTL(code)\r\n          } else if (type == 2) {\r\n            _this.showInput(0)\r\n          } else if (type == 3) {\r\n            _this.loadLocalSTL(url)\r\n          }\r\n          $(_this.dragObj).remove()\r\n          setTimeout(function() {\r\n            _this.onDocumentMouseDown(e)\r\n          }, 100)\r\n        } else {\r\n          $(_this.dragObj).remove()\r\n        }\r\n        _this.dragedFlag = false\r\n        $('.active_shape').removeClass('active_shape')\r\n      }, false)\r\n\r\n      _this.shapesMain.addEventListener('mousedown', function() {\r\n        //隐藏子窗口\r\n        _this.showColorOption = false\r\n        _this.showColorOption = false\r\n      })\r\n      _this.shapesEventL.addEventListener('mousedown', function(e) {\r\n        //隐藏子窗口\r\n        _this.showColorOption = false\r\n        _this.showColorOption = false\r\n        _this.selectedDragObj = $(e.target)\r\n        if (_this.selectedDragObj.hasClass('drag')) {\r\n          $('.active_shape').removeClass('active_shape')\r\n          if (_this.selectedDragObj.hasClass('name')) {\r\n            _this.dragObj = $(_this.selectedDragObj).parents('.module').find('.sprint').clone()\r\n            $(_this.selectedDragObj).parents('.module').addClass('active_shape')\r\n            _this.selectedDragObjFlag = true\r\n          } else if (_this.selectedDragObj.hasClass('sprint')) {\r\n            _this.dragObj = _this.selectedDragObj.clone()\r\n            $(_this.selectedDragObj).parents('.module').addClass('active_shape')\r\n            _this.selectedDragObjFlag = true\r\n          } else if (_this.selectedDragObj.hasClass('module')) {\r\n            _this.dragObj = $(_this.selectedDragObj).find('.sprint').clone()\r\n            $(_this.selectedDragObj).addClass('active_shape')\r\n            _this.selectedDragObjFlag = false\r\n          }\r\n          _this.dragObj.addClass('startDrag')\r\n          // _this.maxW = document.body.clientWidth - _this.selectedDragObj[0].offsetWidth;\r\n          // _this.maxH = document.body.clientHeight - _this.selectedDragObj[0].offsetHeight;\r\n          _this.maxW = $('.builder .main_wrapper').width() - _this.selectedDragObj[0].offsetWidth\r\n          _this.maxH = $('.builder .main_wrapper').height() - _this.selectedDragObj[0].offsetHeight\r\n        }\r\n      }, false)\r\n      _this.shapesEventL.addEventListener('mousemove', function(e) {\r\n        _this.dragedFlag = true\r\n        var ev = e || window.event\r\n        var touch = ev.targetTouches[0]\r\n        var windowWidth = window.innerWidth\r\n        _this.movedDir = windowWidth - touch.clientX\r\n        if (_this.dragObj && _this.movedDir > 100) {\r\n          $('body').append(_this.dragObj)\r\n          var oLeft = touch.clientX - 50\r\n          var oTop = touch.clientY - 50\r\n          if (oLeft < 0) {\r\n            oLeft = 0\r\n          } else if (oLeft >= _this.maxW) {\r\n            oLeft = _this.maxW\r\n          }\r\n          if (oTop < 0) {\r\n            oTop\r\n          } else if (oTop >= _this.maxH) {\r\n            oTop = _this.maxH\r\n          }\r\n          _this.dragObj[0].style.left = oLeft + 25 + 'px'\r\n          _this.dragObj[0].style.top = oTop + 'px'\r\n        }\r\n      }, false)\r\n      _this.shapesEventL.addEventListener('mouseup', function(e) {\r\n        if (_this.dragObj && _this.dragedFlag && _this.movedDir > 100) {\r\n          // $( selectedDragObj ).parents( \".module\" ).trigger( \"click\" );\r\n          let code, type, url\r\n          if (_this.selectedDragObjFlag) {\r\n            code = Number($(_this.selectedDragObj).parents('.module').find('.this_code').val())\r\n            type = Number($(_this.selectedDragObj).parents('.module').find('.this_module').val())\r\n            url = Number($(_this.selectedDragObj).parents('.module').find('.this_url').val())\r\n          } else if (_this.selectedDragObjFlag == false) {\r\n            code = Number($(_this.selectedDragObj).find('.this_code').val())\r\n            type = Number($(_this.selectedDragObj).find('.this_module').val())\r\n            url = Number($(_this.selectedDragObj).find('.this_url').val())\r\n          }\r\n          if (type == 0) {\r\n            _this.changeShapes(code)\r\n          } else if (type == 1) {\r\n            _this.loadSTL(code)\r\n          } else if (type == 2) {\r\n            _this.showInput(0)\r\n          } else if (type == 3) {\r\n            _this.loadLocalSTL(url)\r\n          }\r\n          $(_this.dragObj).remove()\r\n          setTimeout(function() {\r\n            _this.onDocumentMouseDown(e)\r\n          }, 100)\r\n        } else {\r\n          $(_this.dragObj).remove()\r\n        }\r\n        _this.dragedFlag = false\r\n        $('.active_shape').removeClass('active_shape')\r\n      }, false)\r\n    },\r\n    dragImg(e) {\r\n      const _this = this\r\n      //隐藏子窗口\r\n      _this.showColorOption = false\r\n      _this.showColorOption = false\r\n      _this.selectedDragObj = $(e.target)\r\n      if (_this.selectedDragObj.hasClass('drag')) {\r\n        $('.active_shape').removeClass('active_shape')\r\n        if (_this.selectedDragObj.hasClass('name')) {\r\n          _this.dragObj = $(_this.selectedDragObj).parents('.module').find('.sprint').clone()\r\n          $(_this.selectedDragObj).parents('.module').addClass('active_shape')\r\n          _this.selectedDragObjFlag = true\r\n        } else if (_this.selectedDragObj.hasClass('sprint')) {\r\n          _this.dragObj = _this.selectedDragObj.clone()\r\n          $(_this.selectedDragObj).parents('.module').addClass('active_shape')\r\n          _this.selectedDragObjFlag = true\r\n        } else if (_this.selectedDragObj.hasClass('module')) {\r\n          _this.dragObj = $(_this.selectedDragObj).find('.sprint').clone()\r\n          $(_this.selectedDragObj).addClass('active_shape')\r\n          _this.selectedDragObjFlag = false\r\n        }\r\n        _this.dragObj.addClass('startDrag')\r\n        // _this.maxW = document.body.clientWidth - _this.selectedDragObj[0].offsetWidth;\r\n        // _this.maxH = document.body.clientHeight - _this.selectedDragObj[0].offsetHeight;\r\n        _this.maxW = $('.builder .main_wrapper').width() - _this.selectedDragObj[0].offsetWidth\r\n        _this.maxH = $('.builder .main_wrapper').height() - _this.selectedDragObj[0].offsetHeight\r\n      }\r\n    },\r\n    moveImg(e) {\r\n      const _this = this\r\n      _this.dragedFlag = true\r\n      var ev = e || window.event\r\n      var windowWidth = _this.CONTAIN_WIDTH\r\n      _this.movedDir = windowWidth - (ev.clientX)\r\n      if (_this.dragObj && _this.movedDir < 100) {\r\n        $('body').append(_this.dragObj)\r\n        var oLeft = ev.clientX - 50\r\n        var oTop = ev.clientY - 50\r\n        if (oLeft < 0) {\r\n          oLeft = 0\r\n        } else if (oLeft >= _this.maxW) {\r\n          oLeft = _this.maxW\r\n        }\r\n        if (oTop < 0) {\r\n          oTop\r\n        } else if (oTop >= _this.maxH) {\r\n          oTop = _this.maxH\r\n        }\r\n        _this.dragObj[0].style.left = oLeft + 25 + 'px'\r\n        _this.dragObj[0].style.top = oTop + 'px'\r\n      }\r\n    },\r\n    upImg(e) {\r\n      const _this = this\r\n      if (_this.dragObj && _this.dragedFlag && _this.movedDir > 100) {\r\n        // $( selectedDragObj ).parents( \".module\" ).trigger( \"click\" );\r\n        let code, type, url\r\n        if (_this.selectedDragObjFlag) {\r\n          code = Number($(_this.selectedDragObj).parents('.module').find('.this_code').val())\r\n          type = Number($(_this.selectedDragObj).parents('.module').find('.this_module').val())\r\n          url = Number($(_this.selectedDragObj).parents('.module').find('.this_url').val())\r\n        } else if (_this.selectedDragObjFlag == false) {\r\n          code = Number($(_this.selectedDragObj).find('.this_code').val())\r\n          type = Number($(_this.selectedDragObj).find('.this_module').val())\r\n          url = Number($(_this.selectedDragObj).find('.this_url').val())\r\n        }\r\n        if (type == 0) {\r\n          _this.changeShapes(code)\r\n        } else if (type == 1) {\r\n          _this.loadSTL(code)\r\n        } else if (type == 2) {\r\n          _this.showInput(0)\r\n        } else if (type == 3) {\r\n          _this.loadLocalSTL(url)\r\n        }\r\n        $(_this.dragObj).remove()\r\n        setTimeout(function() {\r\n          _this.onDocumentMouseDown(e)\r\n        }, 100)\r\n      } else {\r\n        $(_this.dragObj).remove()\r\n      }\r\n      _this.dragedFlag = false\r\n      $('.active_shape').removeClass('active_shape')\r\n    },\r\n    selectModule(type, code, index, module) {\r\n      if (0 == type && 'text' == module) {\r\n        type = 2\r\n      } else if (0 == type && 'stl' == module) {\r\n        type = 1\r\n      }\r\n      $('.active_shape').removeClass('active_shape')\r\n      var obj\r\n      if (0 == type) {\r\n        obj = $('.normal_wrapper').find('.module:eq(' + index + ')')\r\n        this.stlGeoFlag = 0\r\n        this.changeShapes(code)\r\n      } else if (1 == type) {\r\n        obj = $('.cartoon_wrapper').find('.module:eq(' + index + ')')\r\n        this.stlGeoFlag = 1\r\n        this.loadSTL(code, obj)\r\n      } else if (2 == type) {\r\n        obj = $('.normal_wrapper').find('.module:eq(' + index + ')')\r\n        this.stlGeoFlag = 1\r\n        this.showInput(0)\r\n      }\r\n      obj.addClass('active_shape')\r\n\r\n    },\r\n    showChild(type) {\r\n      if (type == 1) {\r\n        this.showColorOption = true\r\n      } else if (type == 0) {\r\n        this.showZoomOption = true\r\n      }\r\n    },\r\n    zoomView(zoomIndex) {\r\n      if (this.cameraZoom) {\r\n        this.cameraZoom = zoomIndex / 100\r\n        this.camera.zoom = this.cameraZoom\r\n        this.camera.lookAt(this.scene.position)\r\n        this.camera.updateProjectionMatrix()\r\n      }\r\n    },\r\n    changeShapes(geo) {\r\n      this.stlGeoFlag = 0//0 geo; 1 stl\r\n      // stopPropagationFn();\r\n      this.showInput(1)\r\n      this.currentModule = 0//编辑模式，各种基础模型\r\n      // enabledLego( 1 );\r\n      this.shootedFlag = false\r\n      /*if(controls){\r\n        controls.dispose();\r\n      }*/\r\n      switch (geo) {\r\n        case 0:\r\n          // 正方形\r\n          this.currentObj = new THREE.BoxBufferGeometry(this.SHAPE_SIZE, this.SHAPE_SIZE, this.SHAPE_SIZE)\r\n          break\r\n        case 1:\r\n          //圆柱\r\n          this.currentObj = new THREE.CylinderBufferGeometry(this.SHAPE_SIZE / 2, this.SHAPE_SIZE / 2, this.SHAPE_SIZE, 32) //CylinderGeometry(radiusTop : 浮点类型, radiusBottom : 浮点类型, height : 浮点类型, radialSegments : 整数类型, heightSegments : 整数类型, openEnded : 布尔类型, thetaStart : 浮点类型, thetaLength : 浮点类型)\r\n          break\r\n        case 2:\r\n          // 圆锥形\r\n          this.currentObj = new THREE.ConeBufferGeometry(this.SHAPE_SIZE / 2, this.SHAPE_SIZE, 32) //ConeBufferGeometry(radius : Float, height : Float, radialSegments : Integer, heightSegments : Integer, openEnded : Boolean, thetaStart : Float, thetaLength : Float)\r\n          break\r\n        case 3:\r\n          // 球形\r\n          this.currentObj = new THREE.SphereBufferGeometry(this.SHAPE_SIZE / 2, 32, 32)//SphereBufferGeometry(radius : Float, widthSegments : Integer, heightSegments : Integer, phiStart : Float, phiLength : Float, thetaStart : Float, thetaLength : Float)\r\n          break\r\n        case 4:\r\n          // 环形\r\n          this.currentObj = new THREE.TorusGeometry(10, 2.5, 16, 100)//TorusGeometry(radius : Float, tube : Float, radialSegments : Integer, tubularSegments : Integer, arc : Float)\r\n          break\r\n        case 5:\r\n          // 棱柱形prismatic\r\n          this.currentObj = new THREE.CylinderBufferGeometry(this.SHAPE_SIZE / 2, this.SHAPE_SIZE / 2, this.SHAPE_SIZE, 5) //CylinderGeometry(radiusTop : 浮点类型, radiusBottom : 浮点类型, height : 浮点类型, radialSegments : 整数类型, heightSegments : 整数类型, openEnded : 布尔类型, thetaStart : 浮点类型, thetaLength : 浮点类型)\r\n          break\r\n        case 6:\r\n          // 棱锥形Pyramid\r\n          this.currentObj = new THREE.ConeBufferGeometry(this.SHAPE_SIZE / 2, this.SHAPE_SIZE, 4) //ConeBufferGeometry(radius : Float, height : Float, radialSegments : Integer, heightSegments : Integer, openEnded : Boolean, thetaStart : Float, thetaLength : Float)\r\n          break\r\n        case 7:\r\n          // 空心圆柱Hollow cylinder\r\n          var outerRadius = this.SHAPE_SIZE / 2\r\n          var innerRadius = this.SHAPE_SIZE / 3\r\n          var height = this.SHAPE_SIZE\r\n\r\n          var arcShape = new THREE.Shape()\r\n          arcShape.moveTo(outerRadius * 2, outerRadius)\r\n          arcShape.absarc(outerRadius, outerRadius, outerRadius, 0, Math.PI * 2, false)\r\n          var holePath = new THREE.Path()\r\n          holePath.moveTo(outerRadius + innerRadius, outerRadius)\r\n          holePath.absarc(outerRadius, outerRadius, innerRadius, 0, Math.PI * 2, true)\r\n          arcShape.holes.push(holePath)\r\n          var geometry = new THREE.ExtrudeGeometry(arcShape, {\r\n            amount: height,\r\n            bevelEnabled: false,\r\n            steps: 1,\r\n            curveSegments: 60\r\n          })\r\n          geometry.center()\r\n          geometry.rotateX(Math.PI * -.5)\r\n          this.currentObj = geometry//TorusGeometry(radius : Float, tube : Float, radialSegments : Integer, tubularSegments : Integer, arc : Float)\r\n          break\r\n        case 8:\r\n          // 三棱柱\r\n          this.currentObj = new THREE.CylinderBufferGeometry(this.SHAPE_SIZE / 2, this.SHAPE_SIZE / 2, this.SHAPE_SIZE, 3) //CylinderGeometry(radiusTop : 浮点类型, radiusBottom : 浮点类型, height : 浮点类型, radialSegments : 整数类型, heightSegments : 整数类型, openEnded : 布尔类型, thetaStart : 浮点类型, thetaLength : 浮点类型)\r\n          break\r\n        default:\r\n          // 正方形\r\n          this.currentObj = new THREE.BoxBufferGeometry(this.SHAPE_SIZE, this.SHAPE_SIZE, this.SHAPE_SIZE)\r\n      }\r\n      // changeMouseHelper( currentColorFlag );\r\n      this.currentObjMesh = new THREE.Mesh(this.currentObj, this.currentObjMaterial)\r\n    },\r\n    showInput(type) {\r\n      if (type === 0) {\r\n        this.currentObj = null\r\n        this.showTextWindow = true\r\n      } else {\r\n        this.showTextWindow = false\r\n        this.inputCanConfirm = false\r\n        this.textInput = ''\r\n      }\r\n    },\r\n    textInputFn(e) {\r\n      const obj = e.target\r\n      this.textInput = $(obj).val()\r\n      var textLength = $(obj).val().length\r\n      if (textLength > 0) {\r\n        this.inputCanConfirm = true\r\n      } else {\r\n        this.inputCanConfirm = false\r\n      }\r\n    },\r\n    insertWord() {\r\n      const _this = this\r\n      _this.showLoading = true\r\n      _this.showInput(1)\r\n      this.fontLoader.load('/font/SimHei_Regular.json', function(font) {\r\n          _this.wordFont = font\r\n          _this.createText()\r\n          _this.showLoading = false\r\n        },\r\n        // onProgress callback\r\n        function(xhr) {\r\n          // console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );\r\n          _this.progressingBar = (xhr.loaded / xhr.total * 100)\r\n        },\r\n        // onError callback\r\n        function(err) {\r\n          console.error('An error happened :' + err)\r\n        })\r\n    },\r\n    createText() {\r\n      let word = this.textInput1\r\n      const _this = this\r\n      var xMid, text\r\n      var message = word\r\n      var fontSize\r\n      switch (message.length) {\r\n        case 3:\r\n          fontSize = 50\r\n          break\r\n        case 4:\r\n          fontSize = 45\r\n          break\r\n        case 5:\r\n          fontSize = 40\r\n          break\r\n        case 6:\r\n          fontSize = 35\r\n          break\r\n        case 7:\r\n          fontSize = 30\r\n          break\r\n        default:\r\n          fontSize = 20\r\n      }\r\n      var textGeo = new THREE.TextGeometry(message, {\r\n        font: _this.wordFont,\r\n        size: fontSize,\r\n        height: 10, //文字厚度\r\n        curveSegments: 22,\r\n        bevelEnabled: false\r\n      })\r\n      textGeo.computeBoundingBox()\r\n      textGeo.computeVertexNormals()\r\n      var geometry = new THREE.BufferGeometry().fromGeometry(textGeo)\r\n      geometry.computeBoundingBox()\r\n\r\n      xMid = -0.5 * (geometry.boundingBox.max.x - geometry.boundingBox.min.x) //位置，使其居中\r\n      geometry.translate(xMid, -25, 0)\r\n      geometry.rotateX(-(Math.PI / 2)) //文字为横卧在工作台上\r\n      // make shape ( N.B. edge view not visible )\r\n      var matLite = new THREE.MeshPhongMaterial({ color: _this.wordColor, flatShading: true })\r\n      text = new THREE.Mesh(geometry, matLite)\r\n      text.name = 'shapes'\r\n      text.receiveShadow = true\r\n      text.castShadow = true\r\n      _this.scene.add(text)\r\n      _this.objects.push(text)\r\n      _this.shapesObj.push(text) //全删除使用\r\n      this.undoActive = true\r\n      _this.activeSave = true\r\n      _this.transformControl.object = text\r\n      _this.focusedTransformObj = _this.transformControl.object\r\n      _this.cleanSelectedObject(text)\r\n      _this.createObjForOperation(text, 'add')\r\n      _this.eachObjSetps(text, 0)\r\n      _this.shapesController()\r\n      _this.transformControl.attach(_this.focusedTransformObj)\r\n      _this.resetSomeThing()\r\n    },\r\n    async loadSTL(thisSTL, obj) {\r\n      const _this = this\r\n      _this.showInput(1)\r\n      $('.active_shape').removeClass('active_shape')\r\n      $(obj).addClass('active_shape')\r\n      _this.currentModule = 0 //编辑模式，各种基础模型\r\n      // enabledLego( 1 );\r\n      _this.showLoading = true\r\n      _this.shootedFlag = false\r\n      var file\r\n      switch (thisSTL) {\r\n        case 0:\r\n          file = '/models/stl/ascii/standing.stl'\r\n          break\r\n        case 1:\r\n          file = '/models/stl/ascii/climbing.stl'\r\n          break\r\n        case 2:\r\n          file = '/models/stl/ascii/lying.stl'\r\n          break\r\n        case 3:\r\n          file = '/models/stl/ascii/sitting.stl'\r\n          break\r\n        case 4:\r\n          file = '/models/stl/ascii/tyrannosaurusRex.stl'\r\n          break\r\n        case 5:\r\n          file = '/models/stl/ascii/pokemon/bulbasaur_starter_1gen_flowalistik.stl'\r\n          break\r\n        case 6:\r\n          file = '/models/stl/ascii/pokemon/charmander_starter_1gen_flowalistik.stl'\r\n          break\r\n        case 7:\r\n          file = '/models/stl/ascii/pokemon/chikorita_starter_2gen_flowalistik.stl'\r\n          break\r\n        case 8:\r\n          file = '/models/stl/ascii/pokemon/pikachu_1gen_flowalistik.stl'\r\n          break\r\n        case 9:\r\n          file = '/models/stl/ascii/pokemon/squirtle_starter_1gen_flowalistik.stl'\r\n          break\r\n        case 10:\r\n          file = '/models/stl/ascii/pokemon/totodile_starter_2gen_flowalistik.stl'\r\n          break\r\n        case 11:\r\n          file = '/models/stl/ascii/five-point-star.stl'\r\n          break\r\n        default:\r\n          file = '/models/stl/ascii/tyrannosaurusRex.stl'\r\n      }\r\n      var loader = new STLLoader()\r\n      await loader.load(file, function(geometry) {\r\n          _this.currentObj = geometry\r\n          _this.showLoading = false\r\n        },\r\n        function(xhr) {\r\n          _this.progressingBar = (xhr.loaded / xhr.total * 100)\r\n          // console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );\r\n        })\r\n    },\r\n    onDocumentMouseDown() {\r\n      if (!this.shootedFlag) {\r\n        event.preventDefault()\r\n        var controlBoardWidth = !this.showMore //left decal side width\r\n        var touch = null\r\n        if (controlBoardWidth) {\r\n          if (event.type == 'touchend') {\r\n            touch = event.changedTouches[0]\r\n            this.mouse.set((touch.clientX / this.CONTAIN_WIDTH) * 2 - 1, -(touch.clientY / this.CONTAIN_HEIGHT) * 2 + 1)\r\n          } else {\r\n            this.mouse.set((event.clientX / this.CONTAIN_WIDTH) * 2 - 1, -(event.clientY / this.CONTAIN_HEIGHT) * 2 + 1)\r\n          }\r\n        } else {\r\n          if (event.type == 'touchend') {\r\n            touch = event.changedTouches[0]\r\n            this.mouse.set((touch.clientX / (this.CONTAIN_WIDTH - 100)) * 2 - 1, -(touch.clientY / this.CONTAIN_HEIGHT) * 2 + 1)\r\n          } else {\r\n            this.mouse.set((event.clientX / (this.CONTAIN_WIDTH - 100)) * 2 - 1, -(event.clientY / this.CONTAIN_HEIGHT) * 2 + 1)\r\n          }\r\n        }\r\n\r\n        this.raycaster.setFromCamera(this.mouse, this.camera)\r\n\r\n        // var intersects = this.raycaster.intersectObjects( this.objects ,true );\r\n        var intersects = this.raycaster.intersectObjects(this.objects)\r\n\r\n        if (intersects.length > 0) {\r\n\r\n          var intersect = intersects[0]\r\n\r\n          // delete cube\r\n\r\n          if (this.isShiftDown) {\r\n\r\n            if (intersect.object !== this.plane) {\r\n\r\n              this.scene.remove(intersect.object)\r\n\r\n              this.objects.splice(this.objects.indexOf(intersect.object), 1)\r\n\r\n            }\r\n\r\n            // create cube\r\n\r\n          } else {\r\n            // if (this.objects.length < 11 && this.currentObj) {\r\n            if (this.currentObj) {\r\n              var voxelMaterial = this.currentObjMaterial.clone()\r\n              var voxel = new THREE.Mesh(this.currentObj, voxelMaterial)\r\n              voxel.position.copy(intersect.point).add(intersect.face.normal)\r\n              // voxel.position.divideScalar( 50 ).floor().multiplyScalar( 50 ).addScalar(25 );\r\n              if (this.stlGeoFlag == 0) {//0 geo; 1 stl 2, localStl\r\n                voxel.position.divideScalar(this.SHAPE_SIZE).floor().multiplyScalar(this.SHAPE_SIZE).addScalar(this.SHAPE_SIZE / 2)\r\n                voxel.name = 'shapes'\r\n              } else if (this.stlGeoFlag == 1) {\r\n                voxel.position.divideScalar(50).floor().multiplyScalar(50).addScalar(25)\r\n                voxel.name = 'stl'\r\n              } else if (this.stlGeoFlag == 2) {\r\n                voxel.position.divideScalar(50).floor().multiplyScalar(50)\r\n                voxel.name = 'stlLocal'\r\n                voxel.rotation.set(-Math.PI / 2, 0, 0)\r\n              }\r\n              voxel.receiveShadow = true\r\n              voxel.castShadow = true\r\n              this.scene.add(voxel)\r\n              this.objects.push(voxel)\r\n              this.shapesObj.push(voxel) //全删除使用\r\n              this.undoActive = true\r\n              this.activeSave = true\r\n              this.createObjForOperation(voxel, 'add')\r\n              this.eachObjSetps(voxel, 0)\r\n              this.shapesController()\r\n              this.transformControl.object = voxel\r\n              this.transformControl.attach(this.transformControl.object)\r\n              this.cleanSelectedObject(voxel)\r\n              this.showCurrentColor()\r\n              this.resetSomeThing()\r\n            }\r\n          }\r\n          this.shootedFlag = true\r\n          this.render()\r\n\r\n        }\r\n      } else {\r\n        this.checkIntersection(event)\r\n      }\r\n    },\r\n    onDocumentMouseMove() {\r\n      event.preventDefault()\r\n      this.mouse.set((event.clientX / this.CONTAIN_WIDTH) * 2 - 1, -(event.clientY / this.CONTAIN_HEIGHT) * 2 + 1)\r\n      this.raycaster.setFromCamera(this.mouse, this.camera)\r\n      var intersects = this.raycaster.intersectObjects(this.objects)\r\n      if (intersects.length > 0) {\r\n        var intersect = intersects[0]\r\n        this.mouseHelper.position.copy(intersect.point).add(intersect.face.normal)\r\n        this.mouseHelper.position.divideScalar(this.SHAPE_SIZE).floor().multiplyScalar(this.SHAPE_SIZE).addScalar(this.SHAPE_SIZE / 2)\r\n      }\r\n      this.render()\r\n    },\r\n    createObjForOperation(meshObj, type) {\r\n      window.deleteObjFlag = false\r\n      this.saveFlag = false\r\n      if (this.allOperation.length >= 5) {\r\n        this.allOperation.shift()\r\n      }\r\n      var obj = {}\r\n      obj['uuid'] = meshObj.uuid\r\n      obj['position'] = meshObj.position.clone()\r\n      obj['rotation'] = meshObj.rotation.clone()\r\n      obj['quaternion'] = meshObj.quaternion.clone()\r\n      obj['scale'] = meshObj.scale.clone()\r\n      obj['color'] = meshObj.material.color.clone()\r\n      obj['operation'] = type\r\n      obj['mesh'] = meshObj\r\n      this.allOperation.push(obj)\r\n    },\r\n    eachObjSetps(e, type) {//生成json 键的行为对象; e:mesh object  type 0: undo 1: redo\r\n      var obj = {}\r\n      var arr\r\n      if (type === 0) {\r\n        if (!this.eachObjectInfo[e.uuid]) {\r\n          this.eachObjectInfo[e.uuid] = []\r\n        }\r\n        obj['uuid'] = e.uuid\r\n        obj['position'] = e.position.clone()\r\n        obj['rotation'] = e.rotation.clone()\r\n        obj['quaternion'] = e.quaternion.clone()\r\n        obj['scale'] = e.scale.clone()\r\n        obj['color'] = e.material.color.clone()\r\n        obj['mesh'] = e\r\n        obj['time'] = Date.parse(new Date())\r\n        if (this.eachObjectInfo[e.uuid].length) {\r\n          obj['index'] = this.eachObjectInfo[e.uuid].length\r\n        } else {\r\n          obj['index'] = 0\r\n        }\r\n        arr = this.eachObjectInfo[e.uuid]\r\n        arr.push(obj)\r\n      } else if (type === 2) {\r\n        if (!this.eachObjectInfo[e.uuid]) {\r\n          this.eachObjectInfo[e.uuid] = []\r\n        }\r\n        obj['uuid'] = e.uuid\r\n        obj['position'] = e.position.clone()\r\n        obj['rotation'] = e.rotation.clone()\r\n        obj['quaternion'] = e.quaternion.clone()\r\n        obj['scale'] = e.scale.clone()\r\n        obj['color'] = e.color.clone()\r\n        obj['mesh'] = e.mesh\r\n        obj['time'] = Date.parse(new Date())\r\n        if (this.eachObjectInfo[e.uuid].length) {\r\n          obj['index'] = this.eachObjectInfo[e.uuid].length\r\n        } else {\r\n          obj['index'] = 0\r\n        }\r\n        arr = this.eachObjectInfo[e.uuid]\r\n        arr.push(obj)\r\n      } else if (type === 1) {\r\n        if (!this.eachRedoObjectInfo[e.uuid]) {\r\n          this.eachRedoObjectInfo[e.uuid] = []\r\n        }\r\n        obj['uuid'] = e.uuid\r\n        obj['position'] = e.position.clone()\r\n        obj['rotation'] = e.rotation.clone()\r\n        obj['quaternion'] = e.quaternion.clone()\r\n        obj['scale'] = e.scale.clone()\r\n        obj['color'] = e.color.clone()\r\n        obj['mesh'] = e.mesh\r\n        obj['time'] = Date.parse(new Date())\r\n        arr = this.eachRedoObjectInfo[e.uuid]\r\n        arr.push(obj)\r\n      }\r\n    },\r\n    shapesController() {//type 0: normal\r\n      if (this.showMore) {\r\n        $('.obj_control').css({ width: this.CONTAIN_WIDTH - 100 })\r\n      }\r\n      this.controlBar = true\r\n    },\r\n    addSelectedObject(object) {\r\n      this.selectedObjects = []\r\n      this.selectedObjects.push(object)\r\n    },\r\n    cleanSelectedObject(obj) {\r\n      if (obj) {\r\n        this.addSelectedObject(obj)\r\n        // this.outlinePass.selectedObjects = this.selectedObjects;\r\n      }\r\n    },\r\n    showCurrentColor() {\r\n      this.isWhite = false\r\n      if (this.transformControl.object) {\r\n        var thisColor = this.transformControl.object.material.color.toJSON()\r\n        if (thisColor == '14540253') {\r\n          this.isWhite = true\r\n        } else {\r\n          this.isWhite = false\r\n        }\r\n        this.cleanSelectedObject(this.transformControl.object)\r\n        switch (this.transformControlModeType) {\r\n          case 0:\r\n            this.statusTxt = this.textSC\r\n            break\r\n          case 1:\r\n            this.statusTxt = this.textTR\r\n            break\r\n          case 2:\r\n            this.statusTxt = this.textRO\r\n            break\r\n        }\r\n        this.controlType = true\r\n      } else {\r\n        this.controlType = false\r\n      }\r\n    },\r\n    resetSomeThing() {\r\n      $('.active_shape').removeClass('active_shape')\r\n      this.currentObjMaterial = new THREE.MeshLambertMaterial({ color: 0xdddddd })\r\n    },\r\n    checkIntersection(event) {\r\n      var x, y\r\n      if (event.changedTouches) {\r\n        x = event.changedTouches[0].pageX\r\n        y = event.changedTouches[0].pageY\r\n      } else {\r\n        x = event.clientX\r\n        y = event.clientY\r\n      }\r\n      this.mouse.x = (x / this.CONTAIN_WIDTH) * 2 - 1\r\n      this.mouse.y = -(y / this.CONTAIN_HEIGHT) * 2 + 1\r\n\r\n      var controlBoardWidth = this.showMore //left decal side width\r\n      if (controlBoardWidth) {\r\n        this.mouse.x = (x / (this.CONTAIN_WIDTH - 100)) * 2 - 1\r\n        this.mouse.y = -(y / this.CONTAIN_HEIGHT) * 2 + 1\r\n      }\r\n      if (!this.plane) return\r\n      this.raycaster.setFromCamera(this.mouse, this.camera)\r\n      this.raycaster.intersectObject(this.plane, false, this.intersectsSelect)\r\n      var sceneChilds\r\n      if (this.intersectsSelect.length > 0) {\r\n        var p = this.intersectsSelect[0].point\r\n        // mouseHelper.position.set( 0, 0, 0 );\r\n        // mouseHelper.position.copy( p );  //copy intersection position to mouseHelper\r\n        this.intersection.point.copy(p)\r\n        /*1.克隆旧的法线 2.旧法线乘以模型的世界矩阵得到归一化后的法线 3.和一个标量相乘，放大10倍。 4.加上点击点的坐标，进行平移。*/\r\n        var n = this.intersectsSelect[0].face.normal.clone()\r\n        n.transformDirection(this.plane.matrixWorld)\r\n        n.multiplyScalar(10)\r\n        n.add(this.intersectsSelect[0].point)\r\n\r\n        this.intersection.normal.copy(this.intersectsSelect[0].face.normal)\r\n        // mouseHelper.lookAt( n );\r\n\r\n        sceneChilds = this.raycaster.intersectObjects(this.scene.children) //get all objects in the current position of your mouse;\r\n        if (sceneChilds.length > 1) {\r\n          if (sceneChilds && (sceneChilds[0].object.name == 'shapes' || sceneChilds[0].object.name == 'stl' || sceneChilds[0].object.name == 'stlLocal')) {\r\n            this.transformControl.detach(this.transformControl.object)\r\n            this.transformControl.attach(sceneChilds[0].object)\r\n          } else if (sceneChilds[0].object.name == 'plane') {\r\n            this.transformControl.detach()\r\n            this.transformControl.attach(sceneChilds[0].object)\r\n          }\r\n          this.colorControl = true\r\n        }\r\n        this.intersection.intersects = true\r\n        this.intersectsSelect.length = 0\r\n\r\n      } else {\r\n        this.intersection.intersects = false\r\n\r\n        sceneChilds = this.raycaster.intersectObjects(this.scene.children) //get all objects in the current position of your mouse;\r\n        if (sceneChilds.length > 0) {\r\n          if (sceneChilds && (sceneChilds[0].object.name == 'shapes' || sceneChilds[0].object.name == 'stl' || sceneChilds[0].object.name == 'stlLocal')) {\r\n            this.transformControl.detach(this.transformControl.object)\r\n            this.transformControl.attach(sceneChilds[0].object)\r\n          } else if (sceneChilds[0].object.name == 'plane') {\r\n            this.transformControl.detach(this.transformControl.object)\r\n            this.transformControl.attach(sceneChilds[0].object)\r\n          }\r\n        }\r\n      }\r\n      this.render()\r\n    },\r\n    hideSelf() {\r\n      /*this.$parent.showThreeD();*/\r\n      $('.orientationControls').remove()\r\n      this.$router.push({ path: '/projects', query: { jump: 'MagicBox-AppforChildren' } })\r\n    },\r\n    allOperationAdd() {\r\n      if (window.focusedTransformObj) {\r\n        this.createObjForOperation(this.transformControl.object, 'transform')\r\n        this.eachObjSetps(this.transformControl.object, 0)\r\n      }\r\n      if (this.allOperation.length > 0) {\r\n        this.undoActive = true\r\n      } else {\r\n        this.undoActive = false\r\n      }\r\n    },\r\n    checkScalePosition(obj) {\r\n      // 检测是否有放大缩小，如果有，需要检测移动时的范围\r\n      this.tcScale = obj.scale.clone()\r\n      this.tcScaleYPosition = obj.position.clone().y\r\n      this.tcScaleY = obj.scale.clone().y\r\n      if (obj.name == 'shapes') {\r\n        if (this.tcScaleYPosition == ((this.SHAPE_SIZE * obj.scale.y) / 2)) {\r\n          this.tcScaleYPositionFlag = true\r\n        } else {\r\n          this.tcScaleYPositionFlag = false\r\n        }\r\n      } else if (obj.name == 'stl') {\r\n        if (this.tcScaleYPosition == (obj.geometry.boundingSphere.radius)) {\r\n          this.tcScaleYPositionFlag = true\r\n        } else {\r\n          this.tcScaleYPositionFlag = false\r\n        }\r\n      }\r\n    },\r\n    onAnimationStep() { //检测scale，使其永远在0.1- LIMIT_SIZE 之间\r\n      if (this.transformControl.object) {\r\n        var saveDefauleSHAPE_SIZE = this.SHAPE_SIZE\r\n        var saveDefauleLIMIT_SIZE = this.LIMIT_SIZE\r\n        var saveDefauleLIMIT_SIZEMin = 0.1\r\n        var getMode = this.transformControl.getMode()\r\n        var currentObj = this.transformControl.object\r\n        /*if(currentObj.name == \"shapes\"){\r\n\r\n        }else if(currentObj.name == \"stl\"){\r\n          if(currentObj.geometry.boundingSphere) {\r\n            SHAPE_SIZE = ( currentObj.geometry.boundingSphere.radius ) * 2\r\n          }\r\n        }*/\r\n        switch (getMode) {\r\n          case 'scale':\r\n            if (currentObj.name == 'stl') {\r\n              this.LIMIT_SIZE = 2.22\r\n              // saveDefauleLIMIT_SIZEMin = 0.056\r\n            }\r\n            currentObj.scale.clampScalar(saveDefauleLIMIT_SIZEMin, this.LIMIT_SIZE)\r\n            this.checkAxis('scale', currentObj)\r\n            break\r\n          case 'translate':\r\n            // console.log( transformControl.axis, currentObj.position );\r\n            if (this.transformControl.axis == 'X') {\r\n              if (currentObj.position.x >= 0 && currentObj.position.x + ((this.SHAPE_SIZE * currentObj.scale.x) / 2) >= (this.WORK_SPACE_SIZE / 2)) {\r\n                currentObj.position.x = (this.WORK_SPACE_SIZE / 2) - ((this.SHAPE_SIZE * currentObj.scale.x) / 2)\r\n              } else if (currentObj.position.x < 0 && currentObj.position.x - ((this.SHAPE_SIZE * currentObj.scale.x) / 2) <= -(this.WORK_SPACE_SIZE / 2)) {\r\n                currentObj.position.x = -(this.WORK_SPACE_SIZE / 2) + ((this.SHAPE_SIZE * currentObj.scale.x) / 2)\r\n              }\r\n            } else if (this.transformControl.axis == 'Z') {\r\n              if (currentObj.position.z >= 0 && currentObj.position.z + ((this.SHAPE_SIZE * currentObj.scale.z) / 2) >= (this.WORK_SPACE_SIZE / 2)) {\r\n                currentObj.position.z = (this.WORK_SPACE_SIZE / 2) - ((this.SHAPE_SIZE * currentObj.scale.z) / 2)\r\n              } else if (currentObj.position.z < 0 && currentObj.position.z - ((this.SHAPE_SIZE * currentObj.scale.z) / 2) <= -(this.WORK_SPACE_SIZE / 2)) {\r\n                currentObj.position.z = -(this.WORK_SPACE_SIZE / 2) + ((this.SHAPE_SIZE * currentObj.scale.z) / 2)\r\n              }\r\n            } else if (this.transformControl.axis == 'Y') {\r\n              if (currentObj.position.y >= 0 && (currentObj.position.y + ((this.SHAPE_SIZE * currentObj.scale.y) / 2)) >= (this.WORK_SPACE_SIZE)) { //向上移\r\n                currentObj.position.y = (this.WORK_SPACE_SIZE) - ((this.SHAPE_SIZE * currentObj.scale.y) / 2)\r\n              } else if (currentObj.name == 'stl') {\r\n                if (currentObj.position.y < (currentObj.geometry.boundingSphere.radius * currentObj.scale.y)) {\r\n                  currentObj.position.y = (this.SHAPE_SIZE * currentObj.scale.y)\r\n                }\r\n              } else if (currentObj.name == 'stlLocal') {\r\n                if (currentObj.position.y < 0) {\r\n                  currentObj.position.y = 0\r\n                }\r\n              } else if (currentObj.position.y < (this.SHAPE_SIZE * currentObj.scale.y) / 2) {\r\n                currentObj.position.y = (this.SHAPE_SIZE * currentObj.scale.y) / 2\r\n              }\r\n            }\r\n            break\r\n          case 'rotate':\r\n            break\r\n        }\r\n        this.SHAPE_SIZE = saveDefauleSHAPE_SIZE\r\n        this.LIMIT_SIZE = saveDefauleLIMIT_SIZE\r\n      }\r\n    },\r\n    checkAxis(type, obj) { // 改变大小的时候，价差坐标，不能超出工作台\r\n      if (type === 'scale') {\r\n        if (obj.position.x >= 0 && obj.position.x + ((this.SHAPE_SIZE * obj.scale.x) / 2) >= (this.WORK_SPACE_SIZE / 2)) {\r\n          obj.position.x = (this.WORK_SPACE_SIZE / 2) - ((this.SHAPE_SIZE * obj.scale.x) / 2)\r\n        } else if (obj.position.x < 0 && obj.position.x - ((this.SHAPE_SIZE * obj.scale.x) / 2) <= -(this.WORK_SPACE_SIZE / 2)) {\r\n          obj.position.x = -(this.WORK_SPACE_SIZE / 2) + ((this.SHAPE_SIZE * obj.scale.x) / 2)\r\n        }\r\n        if (obj.position.z >= 0 && obj.position.z + ((this.SHAPE_SIZE * obj.scale.z) / 2) >= (this.WORK_SPACE_SIZE / 2)) {\r\n          obj.position.z = (this.WORK_SPACE_SIZE / 2) - ((this.SHAPE_SIZE * obj.scale.z) / 2)\r\n        } else if (obj.position.z < 0 && obj.position.z - ((this.SHAPE_SIZE * obj.scale.z) / 2) <= -(this.WORK_SPACE_SIZE / 2)) {\r\n          obj.position.z = -(this.WORK_SPACE_SIZE / 2) + ((this.SHAPE_SIZE * obj.scale.z) / 2)\r\n        }\r\n        if (obj.position.y >= 0 && obj.position.y <= ((this.SHAPE_SIZE * obj.scale.y) / 2)) {\r\n          obj.position.y = (this.SHAPE_SIZE * obj.scale.y) / 2\r\n        } else if (obj.position.y >= 0 && this.tcScaleYPositionFlag) {\r\n          if (obj.name == 'stl') {\r\n            // console.log(\"stl\",tcScaleYPosition,((obj.geometry.boundingSphere.radius* obj.scale.y )/2));\r\n            if (obj.geometry.boundingSphere) {\r\n              if (this.tcScaleYPosition == ((obj.geometry.boundingSphere.radius * obj.scale.y) / 2)) {\r\n                obj.position.y = obj.geometry.boundingSphere.radius * obj.scale.y\r\n              } else {\r\n                obj.position.y = (this.SHAPE_SIZE * obj.scale.y) / 2\r\n              }\r\n            }\r\n          } else {\r\n            obj.position.y = (this.SHAPE_SIZE * obj.scale.y) / 2\r\n          }\r\n        } else if (obj.position.y < 0) {\r\n          obj.position.y = (this.SHAPE_SIZE * obj.scale.y) / 2\r\n        }\r\n      } else if (type === 'rotate') {\r\n        console.log('check for retate')\r\n      }\r\n    },\r\n    changeControls(type) {\r\n      if (window.deleteObjFlag) {\r\n        return\r\n      }\r\n      this.showColorOption = false\r\n      this.showZoomOption = false//隐藏子窗口\r\n      let obj = event.target\r\n      if (!$(obj).hasClass('control_btn')) {\r\n        obj = $(obj).closest('.control_btn')\r\n      }\r\n      if (this.transformControlModeType == 0 && type == 0) {\r\n        obj.toggleClass('active_control')\r\n      } else if (this.transformControlModeType == 1 && type == 1) {\r\n        obj.toggleClass('active_control')\r\n      } else if (this.transformControlModeType == 2 && type == 2) {\r\n        obj.toggleClass('active_control')\r\n      } else if (this.transformControlModeType == 3 && type == 3) {\r\n        obj.toggleClass('active_control')\r\n      } else {\r\n        $('.active_control').removeClass('active_control')\r\n        obj.addClass('active_control')\r\n      }\r\n      if (!obj.hasClass('active_control')) {\r\n        this.transformControl.detach(this.transformControl.object) //隐藏控制控件\r\n        // this.outlinePass.selectedObjects = [];\r\n      } else {\r\n        this.transformControl.attach(this.transformControl.object) //隐藏控制控件\r\n      }\r\n      switch (type) {\r\n        case 0:\r\n          this.transformControl.setMode('scale')\r\n          this.statusTxt = this.textSC\r\n          this.transformControlModeType = 0\r\n          break\r\n        case 1:\r\n          this.transformControl.setMode('translate')\r\n          this.statusTxt = this.textTR\r\n          this.transformControlModeType = 1\r\n          break\r\n        case 2:\r\n          this.transformControl.setMode('rotate')\r\n          this.statusTxt = this.textRO\r\n          this.transformControlModeType = 2\r\n          break\r\n        default:\r\n          this.transformControl.setMode('translate')\r\n          this.statusTxt = this.textTR\r\n          this.transformControlModeType = 1\r\n      }\r\n      this.transformControl.object ? this.colorControl = true : this.colorControl = false\r\n\r\n    },\r\n    deletedSelected() {\r\n      this.showColorOption = false\r\n      this.showZoomOption = false//隐藏子窗口\r\n      if (window.focusedTransformObj && this.transformControl.object) {\r\n        this.createObjForOperation(this.transformControl.object, 'delete')\r\n        this.eachObjSetps(this.transformControl.object, 0)\r\n        this.scene.remove(this.transformControl.object)\r\n        this.objects.splice(this.objects.indexOf(this.transformControl.object), 1)\r\n        $('.active_control').removeClass('active_control')\r\n        this.colorControl = false\r\n        window.deleteObjFlag = true\r\n      }\r\n      this.transformControl.detach()\r\n      // $(\".active_control\").removeClass(\"active_control\");\r\n      this.shapesController(0)\r\n      this.render()\r\n      if (this.objects.length > 1) {\r\n        this.activeSave = true\r\n      } else {\r\n        this.activeSave = false\r\n        this.controlBar = false\r\n      }\r\n\r\n    },\r\n    changeCurrentColor(type) {\r\n      this.isWhite = false\r\n      if (this.transformControl.object) {\r\n        if (type == 0) {\r\n          this.transformControl.object.material.color.set('#dddddd')\r\n          this.isWhite = true\r\n        } else {\r\n          this.transformControl.object.material.color.set('#f2f545')\r\n          this.isWhite = false\r\n        }\r\n        this.createObjForOperation(this.transformControl.object, 'transform')\r\n        this.eachObjSetps(this.transformControl.object, 0)\r\n      }\r\n    },\r\n    redoUndo(type) { //type 0: undo 1: redo\r\n      this.showColorOption = false\r\n      this.showZoomOption = false//隐藏子窗口\r\n      var transformFlag = false\r\n      var deleteFlag = false\r\n      var addFlag = false\r\n      if (type === 0) {\r\n        if (this.allOperation.length > 0) {\r\n          var operationL = this.allOperation[this.allOperation.length - 1]//最后一个last\r\n          this.redoOperation.push(operationL) //add the undo to redo\r\n          if (operationL.operation === 'transform') {\r\n            transformFlag = true\r\n          } else if (operationL.operation === 'delete') {\r\n            deleteFlag = true\r\n          } else if (operationL.operation === 'add') {\r\n            addFlag = true\r\n          }\r\n          if (addFlag) {\r\n            if (operationL.mesh) {\r\n              this.eachObjSetps(operationL, 1)\r\n              this.scene.remove(operationL.mesh)\r\n              this.objects.splice(this.objects.indexOf(operationL.mesh), 1)\r\n            }\r\n          } else if (deleteFlag) {\r\n            if (operationL.mesh) {\r\n              this.eachObjSetps(operationL, 1)\r\n              this.scene.add(operationL.mesh)\r\n              this.objects.push(operationL.mesh)\r\n            }\r\n          } else if (transformFlag) {\r\n            var thisObj = this.eachObjectInfo[operationL.uuid] //寻找对应对象步骤\r\n            if (thisObj) {\r\n              if (thisObj.length > 1) {\r\n                this.redoProcess(thisObj[thisObj.length - 2])\r\n              } else {\r\n                this.redoProcess(thisObj[thisObj.length - 1])\r\n              }\r\n              this.eachObjSetps(this.eachObjectInfo[operationL.uuid].pop(), 1)\r\n            }\r\n          }\r\n          this.allOperation.pop()\r\n        }\r\n\r\n      } else if (type === 1) {\r\n        if (this.redoOperation.length > 0) {\r\n          var redoOperationL = this.redoOperation[this.redoOperation.length - 1]//最后一个last\r\n          this.allOperation.push(redoOperationL) //add the undo to redo\r\n          if (redoOperationL.operation === 'transform') {\r\n            transformFlag = true\r\n          } else if (redoOperationL.operation === 'delete') {\r\n            deleteFlag = true\r\n          } else if (redoOperationL.operation === 'add') {\r\n            addFlag = true\r\n          }\r\n          if (addFlag) {\r\n            if (redoOperationL.mesh) {\r\n              this.eachObjSetps(redoOperationL, 2)\r\n              this.scene.add(redoOperationL.mesh)\r\n              this.objects.push(redoOperationL.mesh)\r\n            }\r\n          } else if (deleteFlag) {\r\n            if (redoOperationL.mesh) {\r\n              this.eachObjSetps(redoOperationL, 2)\r\n              this.scene.remove(redoOperationL.mesh)\r\n              this.objects.splice(this.objects.indexOf(redoOperationL.mesh), 1)\r\n\r\n            }\r\n          } else if (transformFlag) {\r\n            var thisObj1 = this.eachRedoObjectInfo[redoOperationL.uuid] //寻找对应对象步骤\r\n            if (thisObj1) {\r\n              if (thisObj1.length > 1) {\r\n                this.redoProcess(thisObj1[thisObj1.length - 2])\r\n              } else {\r\n                this.redoProcess(thisObj1[thisObj1.length - 1])\r\n              }\r\n              this.eachObjSetps(this.eachRedoObjectInfo[redoOperationL.uuid].pop(), 2)\r\n            }\r\n          }\r\n          this.redoOperation.pop()\r\n        }\r\n      }\r\n      this.transformControl.detach() //隐藏控制控件\r\n      // this.outlinePass.selectedObjects = [];\r\n      this.colorControl = false\r\n      this.render()\r\n      if (this.allOperation.length > 0) {\r\n        this.undoActive = true\r\n      } else {\r\n        this.undoActive = false\r\n      }\r\n      if (this.redoOperation.length > 0) {\r\n        this.redoActive = true\r\n      } else {\r\n        this.redoActive = false\r\n      }\r\n      if (this.objects.length > 1) {\r\n        this.activeSave = true\r\n      } else {\r\n        this.activeSave = false\r\n      }\r\n\r\n    },\r\n    redoProcess(operator) {\r\n      operator.mesh.position.copy(operator.position)\r\n      operator.mesh.rotation._x = operator.rotation._x\r\n      operator.mesh.rotation._y = operator.rotation._y\r\n      operator.mesh.rotation._z = operator.rotation._z\r\n      operator.mesh.quaternion._x = operator.quaternion._x\r\n      operator.mesh.quaternion._y = operator.quaternion._y\r\n      operator.mesh.quaternion._z = operator.quaternion._z\r\n      operator.mesh.scale.set(operator.scale.x, operator.scale.y, operator.scale.z)\r\n      operator.mesh.material.color.set(operator.color)\r\n    },\r\n    saveModuleShow(type) {\r\n      if (this.objects.length > 1) {\r\n        if (type == 0) {\r\n          this.saveNmaeWindow = true\r\n        } else {\r\n          this.saveNmaeWindow = false\r\n        }\r\n      } else {\r\n        this.saveNmaeWindow = false\r\n      }\r\n    },\r\n    getTimeStr() {\r\n      var date = new Date()\r\n      var Y = date.getFullYear()\r\n      var M = (date.getMonth() + 1) < 10 ? ('0' + (date.getMonth() + 1)) : (date.getMonth() + 1)\r\n      var D = date.getDate() < 10 ? ('0' + date.getDate()) : date.getDate()\r\n      var h = date.getHours() < 10 ? ('0' + date.getHours()) : date.getHours()\r\n      var m = date.getMinutes() < 10 ? ('0' + date.getMinutes()) : date.getMinutes()\r\n      var s = date.getSeconds() < 10 ? ('0' + date.getSeconds()) : date.getSeconds()\r\n      var dateStr = Y + M + D + h + m + s\r\n      return dateStr\r\n    },\r\n    exportMoudle(type) { //type 0: ASCII 1: GLTF\r\n      if (this.objects.length > 1) {\r\n        this.scene.remove(this.transformControl)\r\n        this.clearCache(this.gridHelper)\r\n        this.scene.remove(this.gridHelper)\r\n        this.clearCache(this.gradGroundMesh)\r\n        this.scene.remove(this.gradGroundMesh)\r\n        this.clearCache(this.gradGroundMesh1)\r\n        this.scene.remove(this.gradGroundMesh1)\r\n        this.clearCache(this.plane)\r\n        this.scene.remove(this.plane)\r\n        // this.outlinePass.selectedObjects = [];\r\n        this.camera.position.set(170, 145, 255) //45°\r\n        this.camera.lookAt(0, 0, 0)\r\n        //threejs Y-up, 别的事Z-up,所以到处之前要旋转\r\n        this.scene.rotation.set(Math.PI / 2, 0, 0)\r\n        this.scene.updateMatrixWorld()\r\n        //end\r\n        var nameStr = $('#save_name').val()\r\n        // var successFlag;\r\n        if (nameStr) {\r\n          this.saveFlag = true\r\n          if (type === 0) {\r\n            var exporter = new STLExporter() //导出工具  exporter tool\r\n            var result = exporter.parse(this.scene)\r\n            this.saveString(result, nameStr + '.stl')\r\n          } else {\r\n            var input = this.scene\r\n            var gltfExporter = new THREE.GLTFExporter()\r\n            var options = {\r\n              trs: false,\r\n              onlyVisible: true,\r\n              truncateDrawRange: true,\r\n              binary: false,\r\n              forcePowerOfTwoTextures: false,\r\n              maxTextureSize: 4096\r\n            }\r\n            gltfExporter.parse(input, function(result) {\r\n              var output = JSON.stringify(result, null, 2)\r\n              this.saveString(output, nameStr + '.gltf')\r\n            }, options)\r\n          }\r\n        }\r\n        /*\r\n                            if (successFlag) {\r\n                                this.saveAsImage(nameStr + '.png' );\r\n                                // 保存成功，清空当前项目 end\r\n                            } else {\r\n                                $( \".save_name_verify\" ).text( \"保存失败，请重试\" ).show();\r\n                                setTimeout( function () {\r\n                                    $( \".save_name_verify\" ).text( \"请输入模型名称\" ).hide();\r\n                                }, 1500 );\r\n                            }*/\r\n        this.scene.add(this.transformControl)\r\n        this.scene.add(this.gridHelper)\r\n        this.scene.add(this.gradGroundMesh)\r\n        this.scene.add(this.gradGroundMesh1)\r\n        this.scene.add(this.plane)\r\n        //threejs Y-up, 别的事Z-up,所以到处之前要旋转\r\n        this.scene.rotation.set(0, 0, 0)\r\n        this.scene.updateMatrixWorld()\r\n        //end\r\n      }\r\n    },\r\n    saveString(text, filename) {\r\n      this.save(new Blob([text], { type: 'text/plain' }), filename)\r\n    },\r\n    save(blob, filename) {\r\n      var link = document.createElement('a')\r\n      link.style.display = 'none'\r\n      link.className = 'saveFile'\r\n      document.body.appendChild(link)\r\n      link.href = URL.createObjectURL(blob)\r\n      link.download = filename\r\n      link.click()\r\n      $('.saveFile').remove()\r\n      this.afterSTLImg()\r\n    },\r\n    afterSTLImg() {\r\n      this.saveModuleShow(1)\r\n      // 保存成功，清空当前项目\r\n      for (const i in this.objects) {\r\n        this.clearCache(this.objects[i])\r\n        this.scene.remove(this.objects[i])\r\n      }\r\n      this.objects = []\r\n      this.objects.push(this.plane)\r\n      this.transformControl.detach()\r\n      this.activeSave = false\r\n      this.controlBar = false\r\n      if (this.goHomeFlag) {\r\n        this.goHomeFlag = false\r\n        this.saveFlag = false\r\n        this.hideSelf()\r\n      } else {\r\n        this.goHomeFlag = false\r\n        this.saveFlag = false\r\n      }\r\n    },\r\n    leaveBuilder() {\r\n      if (this.objects.length > 1) {\r\n        if (this.saveFlag) {\r\n          this.hideSelf()\r\n        } else {\r\n          this.notSaveNote = true\r\n        }\r\n      } else {\r\n        this.hideSelf()\r\n      }\r\n    },\r\n    hideAskWindow() {\r\n      this.notSaveNote = false\r\n    },\r\n    goHomeSaveModule(type) {//type 0:gohome 1; save\r\n      this.notSaveNote = false\r\n      if (type === 0) {\r\n        this.hideSelf()\r\n      } else {\r\n        this.saveModuleShow(0)\r\n        this.goHomeFlag = true\r\n      }\r\n    },\r\n    windowReisze() {\r\n      const _this = this\r\n      _this.CONTAIN_WIDTH = document.getElementById('mainWrapper').offsetWidth\r\n      _this.CONTAIN_HEIGHT = document.getElementById('mainWrapper').offsetHeight\r\n      _this.onWindowResize()\r\n    }\r\n  },\r\n  mounted() {\r\n    this.showLoading = true\r\n    this.mobile = /Android|webOS|iPhone|iPad|BlackBerry/i.test(navigator.userAgent)\r\n    this.container = document.getElementById('container')\r\n    this.shapesEventL = document.getElementById('childWrapper')\r\n    this.shapesMain = document.getElementById('shapes')\r\n    this.currentObjMaterial = new THREE.MeshLambertMaterial({ color: 0xdddddd })\r\n    this.fontLoader = new THREE.FontLoader()\r\n    this.mouseHelperMaterial = this.currentObjMaterial\r\n    this.CONTAIN_HEIGHT = document.getElementById('mainWrapper').offsetHeight\r\n    this.CONTAIN_WIDTH = document.getElementById('mainWrapper').offsetWidth\r\n    window.focusedTransformObj = this.focusedTransformObj\r\n    window.deleteObjFlag = this.deleteObjFlag\r\n    this.init()\r\n    this.listModule()\r\n    window.addEventListener('resize', this.windowReisze)\r\n    this.progressingBar = 0\r\n    let proInterval = setInterval(() => {\r\n      this.progressingBar += 10\r\n    }, 100)\r\n    setTimeout(() => {\r\n      clearInterval(proInterval)\r\n      this.showLoading = false\r\n    }, 1000)\r\n  },\r\n  computed:{\r\n    textTR() {\r\n      return  `${this.$t('CURRENT_STATUS')} ${this.$t('MOVE')}`\r\n    },\r\n    textSC() {\r\n      return  `${this.$t('CURRENT_STATUS')} ${this.$t('CHANGE_SIZE')}`\r\n    },\r\n    textRO() {\r\n      return  `${this.$t('CURRENT_STATUS')} ${this.$t('ROTATE')}`\r\n    }\r\n  },\r\n  destroyed() {\r\n    const _this = this\r\n    window.removeEventListener('resize', this.windowReisze)\r\n    _this.controls.removeEventListener('change')\r\n    _this.transformControl.removeEventListener('dragging-changed')\r\n    _this.transformControl.removeEventListener('change')\r\n    _this.transformControl.removeEventListener('mouseDown')\r\n    _this.transformControl.removeEventListener('objectChange')\r\n    _this.transformControl.removeEventListener('mouseUp')\r\n    $('.orientationControls').remove() // 删除orientation的旋转方块\r\n  },\r\n  //keep-alive 激活状态，无法销毁监听，需要使用deactivated来销毁\r\n  deactivated() {\r\n    const _this = this\r\n    window.removeEventListener('resize', this.windowReisze)\r\n    _this.controls.removeEventListener('change')\r\n    _this.transformControl.removeEventListener('dragging-changed')\r\n    _this.transformControl.removeEventListener('change')\r\n    _this.transformControl.removeEventListener('mouseDown')\r\n    _this.transformControl.removeEventListener('objectChange')\r\n    _this.transformControl.removeEventListener('mouseUp')\r\n    $('.orientationControls').remove() // 删除orientation的旋转方块\r\n  },\r\n  watch: {\r\n    CONTAIN_WIDTH(newVal) {\r\n      if (newVal) {\r\n        this.CONTAIN_WIDTH = document.getElementById('mainWrapper').offsetWidth\r\n        this.CONTAIN_HEIGHT = document.getElementById('mainWrapper').offsetHeight\r\n      }\r\n    },\r\n    CONTAIN_HEIGHT(newVal) {\r\n      if (newVal) {\r\n        this.CONTAIN_WIDTH = document.getElementById('mainWrapper').offsetWidth\r\n        this.CONTAIN_HEIGHT = document.getElementById('mainWrapper').offsetHeight\r\n      }\r\n    },\r\n    focusedTransformObj(newVal) {\r\n      if (newVal) {\r\n        console.log('change the focusedTransformObj')\r\n        window.focusedTransformObj = this.focusedTransformObj\r\n      }\r\n    },\r\n    textInput(newVal, oldVal) {\r\n      if (newVal) {\r\n        console.log('changed textInput')\r\n        console.log('oldVal:' + oldVal)\r\n        console.log('newVal:' + newVal)\r\n        this.textInput1 = newVal\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang='stylus'>\r\nRIGHT-WIDTH = 1rem;\r\nRIGHT-WIDTH-EN = 1.3rem;\r\n\r\n.builder\r\n  position: relative;\r\n  margin auto\r\n\r\n  .main_wrapper\r\n    width 100%\r\n    height 100%\r\n    min-height: 5rem;\r\n    margin auto\r\n    position: relative;\r\n    /*@media screen and (max-width: 768px)*/\r\n\r\n    #container\r\n      width 100%\r\n      height 100%\r\n      min-height: 5rem;\r\n      background: #79B1EA; /* Old browsers */\r\n      background: -moz-linear-gradient(top, #79B1EA 0%, #4E92EF 100%); /* FF3.6-15 */\r\n      background: -webkit-linear-gradient(top, #79B1EA 0%, #4E92EF 100%); /* Chrome10-25,Safari5.1-6 */\r\n      background: linear-gradient(to bottom, #79B1EA 0%, #4E92EF 100%);\r\n\r\n    /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\r\n\r\n    .show_more\r\n      position: absolute;\r\n      top: 50%;\r\n      right RIGHT-WIDTH\r\n      transform translate(0, -50%)\r\n      cursor pointer\r\n      z-index: 3;\r\n      background: #F0F7FF;\r\n      border-radius: .1rem 0 0 .1rem;\r\n      width: .15rem;\r\n      height: .6rem;\r\n\r\n      img\r\n        position: absolute;\r\n        left: 4px;\r\n        top: 25px;\r\n        cursor: pointer;\r\n        width: .05rem;\r\n        height: .1rem;\r\n\r\n    .show_more.show_more_close\r\n      right: 0;\r\n\r\n    .show_more_close img\r\n      transform: rotate(180deg);\r\n      -ms-transform: rotate(180deg); /* IE 9 */\r\n      -moz-transform: rotate(180deg); /* Firefox */\r\n      -webkit-transform: rotate(180deg); /* Safari 和 Chrome */\r\n      -o-transform: rotate(180deg);\r\n\r\n    /* Opera */\r\n\r\n    #shapes\r\n      position: absolute;\r\n      right 0\r\n      top 0\r\n      bottom 0\r\n      width RIGHT-WIDTH\r\n      background: #F0F7FF;\r\n      color: #000;\r\n      text-align: center;\r\n      font-size: .14rem;\r\n      line-height: 0.3rem;\r\n      z-index: 6;\r\n\r\n      *\r\n        color: #323232;\r\n\r\n      .arrow\r\n        color: #999999;\r\n\r\n      .shapes_wrapper\r\n        cursor pointer\r\n\r\n    #childWrapper\r\n      height: 100%;\r\n      overflow: auto;\r\n      background: #F0F7FF;\r\n      position: absolute;\r\n      right 0\r\n      top 0\r\n      bottom 0\r\n      width RIGHT-WIDTH\r\n      max-width: RIGHT-WIDTH;\r\n      z-index: 5;\r\n\r\n      .child_wrapper\r\n        height: 100%;\r\n        max-width: RIGHT-WIDTH;\r\n        background: #F0F7FF;\r\n        cursor pointer\r\n\r\n        .child_title\r\n          font-size: .14rem;\r\n          position: absolute;\r\n          top: 0;\r\n          right: 0;\r\n          left: 0;\r\n          z-index: 2;\r\n          width: RIGHT-WIDTH;\r\n          background: #F0F7FF;\r\n          text-align: left;\r\n          line-height: 0.3rem;\r\n\r\n        .module.active_shape\r\n          background: rgba(118, 174, 234, .3) !important;\r\n\r\n        .module.cube, .module.standing\r\n          margin-top: .32rem;\r\n\r\n        .module\r\n          position: relative;\r\n          width: RIGHT-WIDTH;\r\n          height: .75rem;\r\n          float: left;\r\n\r\n          img\r\n            margin: .1rem auto 0;\r\n            max-width: 50%;\r\n            max-height: 50%;\r\n\r\n          .name\r\n            text-align: center;\r\n            width: 100%;\r\n            font-size: .12rem;\r\n            line-height: .12rem;\r\n\r\n          .sprint\r\n            width: .5rem;\r\n            height: .5rem;\r\n            margin: .07rem auto 0;\r\n            background-repeat: no-repeat;\r\n            background-size: cover;\r\n            background-position: -50px 0;\r\n\r\n          .sprintY, .sprint_fivepointstar\r\n            background-position: 0 0;\r\n\r\n  .module_btns\r\n    position: absolute\r\n    top .1rem\r\n    left .1rem\r\n\r\n    .module_btn_name\r\n      font-size: .12rem;\r\n      color: #FFFFFF;\r\n      text-align: center;\r\n\r\n    .btn_main.save_module\r\n      margin-left: .1rem;\r\n\r\n      .btn_child .iconfont\r\n        font-size: .25rem;\r\n        line-height: .41rem;\r\n\r\n    .btn_main\r\n      float: left\r\n      cursor pointer\r\n\r\n      .btn_child\r\n        width: .44rem;\r\n        height: .44rem;\r\n        background-image: url(\"/image/3dBuilder/3dPrinting/btn_bg_blue.png\");\r\n        background-repeat: no-repeat;\r\n        background-size: contain;\r\n        position: relative;\r\n\r\n        .iconfont\r\n          font-size: .28rem;\r\n          line-height: .4rem;\r\n          color: #fff;\r\n          left: 0;\r\n          display: block;\r\n          text-align: center;\r\n\r\n    .save_module\r\n      left: .5rem\r\n\r\n    .save_module.noActive_save\r\n      opacity: .3\r\n\r\n  .obj_control\r\n    position: absolute\r\n    bottom 0\r\n    left 0\r\n    right 0\r\n\r\n    *\r\n      color: #2B9CFF;\r\n\r\n    .obj_control_wrapper\r\n      width: fit-content;\r\n      height: .54rem;\r\n      position: relative;\r\n      margin: 0 auto;\r\n      background: #fff;\r\n      border-radius: .2rem .2rem 0 0;\r\n      text-align: center;\r\n      top: 0;\r\n      padding: .05rem .1rem;\r\n      cursor pointer\r\n\r\n      .control_btn.color_control\r\n        padding-top: .1rem;\r\n\r\n      .control_btn\r\n        color: #79c2de;\r\n        font-size: .2rem;\r\n        float: left;\r\n        min-width: .3rem;\r\n        min-height: .3rem;\r\n        padding: 0 .1rem;\r\n        position: relative;\r\n\r\n        .iconfont\r\n          font-size: .2rem;\r\n          line-height: .26rem;\r\n          width: .28rem;\r\n          height: .28rem;\r\n          display: block;\r\n          margin: auto;\r\n\r\n        .btn_name\r\n          font-size: .1rem;\r\n          font-family: \"webfont5\", serif;\r\n          line-height: .16rem;\r\n\r\n        .color_wrapper\r\n          width: 170%;\r\n          position: absolute;\r\n          top: -.55rem;\r\n          left: -.15rem;\r\n          right: 0;\r\n          background: #FFF;\r\n          border-radius: .05rem;\r\n          box-shadow: 0px 0px 0.21rem 0px rgba(145, 96, 34, 0.2);\r\n\r\n          .color_control\r\n            display: inline-block;\r\n\r\n            .color_circle\r\n              margin: .1rem .05rem;\r\n\r\n          .white_control\r\n            .color_circle\r\n              background: #fff;\r\n              border: 1px solid #BABBBB\r\n\r\n        .outside_color\r\n          margin: .015rem auto;\r\n\r\n        .white_color_circle\r\n          background: #fff;\r\n          border: 1px solid #BABBBB\r\n\r\n        .zoom_options\r\n          position: absolute;\r\n          top: -.65rem;\r\n          left: 0;\r\n          right: 0;\r\n          background: #FFF;\r\n          border-radius: .05rem;\r\n          box-shadow: 0px 0px 0.21rem 0px rgba(145, 96, 34, 0.2);\r\n\r\n          .zoom_opt\r\n            font-size: .15rem;\r\n            line-height: .2rem;\r\n\r\n      .active_control\r\n        .icon_wrapper\r\n          width: .28rem;\r\n          height: .28rem;\r\n          color: #FFF;\r\n          margin: auto;\r\n          background-image: url(\"/image/3dBuilder/active_bg.png\");\r\n          background-repeat: no-repeat;\r\n          background-size: cover;\r\n\r\n        .iconfont\r\n          color: #FFF\r\n\r\n        .btn_name\r\n          color: #FFB93F\r\n\r\n      .noActive_control\r\n        .iconfont\r\n          color: #eee;\r\n\r\n      .color_circle\r\n        width: .25rem;\r\n        height: .25rem;\r\n        background: #f2f545;\r\n        margin: auto;\r\n        border-radius: 50%;\r\n\r\n      .active_color\r\n        border: 1px solid #2067C8\r\n\r\n\r\n  .save_name_module_bg, .save_ask_module_bg\r\n    position: fixed;\r\n    top: 0;\r\n    right: 0;\r\n    left: 0;\r\n    bottom: 0;\r\n    background: #000;\r\n    opacity: .3;\r\n    z-index: 3;\r\n\r\n  .save_name_module, .save_ask\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    z-index: 4;\r\n    border-radius: .35rem;\r\n    width: 3.15rem;\r\n    height: 2rem;\r\n    margin-top: -1rem;\r\n    margin-left: -1.575rem;\r\n    text-align: center;\r\n    background: rgba(185, 239, 255, 1);\r\n    box-shadow: 0px 0px 11px 0px rgba(34, 87, 145, 0.2), 0px 0px 125px 0px rgba(56, 154, 240, 1) inset;\r\n\r\n    .save_name_title, .save_ask .save_name_title\r\n      width: 1.47rem;\r\n      height: .33rem;\r\n      background: linear-gradient(0deg, rgba(85, 182, 227, 1) 0%, rgba(54, 129, 227, 1) 100%);\r\n      border-radius: 0 0 .15rem .15rem;\r\n      line-height: .33rem;\r\n      margin: auto;\r\n      font-size: .18rem;\r\n      color: #323232;\r\n\r\n    .save_name_tip\r\n      margin: .15rem 0;\r\n\r\n    #save_name\r\n      width: 90%;\r\n      margin-top: .1rem;\r\n      padding: 0 .1rem;\r\n      font-size: .12rem;\r\n      height: .4rem;\r\n      line-height: .4rem;\r\n      border-radius: .1rem;\r\n      background: rgba(255, 255, 255, 1);\r\n      box-shadow: 3px 2px 2px 0px rgba(85, 182, 227, 0.64) inset;\r\n      border: none;\r\n      outline: none;\r\n      color: #323232;\r\n\r\n    .btn_wrapper\r\n      .save_name_cancle\r\n        position: absolute;\r\n        top: -.14rem;\r\n        right: -.1rem;\r\n        width: .45rem;\r\n\r\n      img.save_name_ok, img.go_home_ok\r\n        width: .9rem;\r\n        height: auto;\r\n        margin: .12rem .2rem 0 .2rem;\r\n\r\n    .save_name_verify\r\n      display: none;\r\n      color: red;\r\n      position: absolute;\r\n      bottom: .62rem;\r\n      left: .23rem;\r\n      background: #fff;\r\n\r\n  .save_ask\r\n    .save_name_title\r\n      color: #fff\r\n\r\n    .save_name_tip\r\n      margin: .3rem .3rem .1rem;\r\n      text-align: left;\r\n      line-height: 0.25rem;\r\n      color: #426A8D;\r\n\r\n  .note\r\n    display: none;\r\n    width: 1.1rem;\r\n    background: #7BB3FF;\r\n    border-radius: 5px;\r\n    position: fixed;\r\n    top: .91rem;\r\n    left: .1rem;\r\n    font-size: 0.1rem;\r\n    color: #426A8D;\r\n    line-height: .13rem;\r\n    padding: .04rem;\r\n\r\n  .text_window\r\n    position: fixed;\r\n    top: .1rem;\r\n    right: 2.5rem;\r\n    width: 1.5rem;\r\n    background: #fff;\r\n    border-radius: 4px;\r\n    font-size: .14rem;\r\n    text-align: center;\r\n    z-index: 2;\r\n\r\n    .text_title\r\n      border-radius: 4px 4px 0 0;\r\n      background: #eee;\r\n      line-height: .2rem;\r\n\r\n    #textContent\r\n      width: 90%;\r\n      border: 1px solid #999;\r\n      border-radius: 4px;\r\n      margin-top: .1rem;\r\n      padding: 0 .05rem;\r\n      font-size: .12rem;\r\n\r\n    .btn_wrapper\r\n      .btns\r\n        height: .25rem;\r\n        width: .5rem;\r\n        background: #79B1EA;\r\n        border-radius: .1rem;\r\n        line-height: .25rem;\r\n        display: inline-block;\r\n        margin: .05rem;\r\n        color: #fff;\r\n        cursor pointer\r\n\r\n      .btn_disable\r\n        background: #eee;\r\n        pointer-events: none;\r\n\r\n  .control_type\r\n    background: #7BB3FF;\r\n    border-radius: 5px;\r\n    position: fixed;\r\n    top: 1rem;\r\n    left: .1rem;\r\n    font-size: 0.15rem;\r\n    color: #426A8D;\r\n    line-height: .2rem;\r\n    padding: .07rem;\r\n\r\n  .main_wrapper.main_wrapper_en_us\r\n    .show_more\r\n      right RIGHT-WIDTH-EN\r\n\r\n    #shapes, #childWrapper\r\n      width RIGHT-WIDTH-EN\r\n      max-width: RIGHT-WIDTH-EN\r\n\r\n      .child_wrapper\r\n        width RIGHT-WIDTH-EN\r\n        max-width: RIGHT-WIDTH-EN\r\n\r\n        .child_title, .module\r\n          width RIGHT-WIDTH-EN\r\n\r\n.builder.fixedBuilder\r\n  position fixed\r\n  top 0\r\n  bottom 0\r\n  left 0\r\n  right 0\r\n  z-index: 99;\r\n\r\n.red {\r\n  color: red;\r\n}\r\n\r\n.blue {\r\n  color: blue;\r\n}\r\n\r\n.green {\r\n  color: lawngreen;\r\n}\r\n\r\n.startDrag {\r\n  max-width: .9rem;\r\n  max-height: .9rem;\r\n  z-index: 99999;\r\n  position: absolute;\r\n}\r\n\r\n</style>\r\n"],"sourceRoot":""}